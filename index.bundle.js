/*! For license information please see index.bundle.js.LICENSE.txt */
(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();const t=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let s=e.charCodeAt(i);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):55296==(64512&s)&&i+1<e.length&&56320==(64512&e.charCodeAt(i+1))?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++i)),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},n={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let t=0;t<e.length;t+=3){const s=e[t],r=t+1<e.length,o=r?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,u=s>>2,h=(3&s)<<4|o>>4;let l=(15&o)<<2|c>>6,d=63&c;a||(d=64,r||(l=64)),i.push(n[u],n[h],n[l],n[d])}return i.join("")},encodeString(e,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(e):this.encodeByteArray(t(e),n)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const s=e[n++];if(s<128)t[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=e[n++];t[i++]=String.fromCharCode((31&s)<<6|63&r)}else if(s>239&&s<365){const r=((7&s)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(r>>10)),t[i++]=String.fromCharCode(56320+(1023&r))}else{const r=e[n++],o=e[n++];t[i++]=String.fromCharCode((15&s)<<12|(63&r)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let t=0;t<e.length;){const s=n[e.charAt(t++)],r=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==s||null==r||null==o||null==a)throw Error();const c=s<<2|r>>4;if(i.push(c),64!==o){const e=r<<4&240|o>>2;if(i.push(e),64!==a){const e=o<<6&192|a;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},i=function(e){return function(e){const i=t(e);return n.encodeByteArray(i,!0)}(e).replace(/\./g,"")};class s{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function r(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function o(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(r())}function a(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function c(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function u(){const e=r();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function h(){return"object"==typeof indexedDB}function l(){return new Promise(((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var e;t((null===(e=s.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}class d extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,d.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,f.prototype.create)}}class f{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],r=s?function(e,t){return e.replace(p,((e,n)=>{const i=t[n];return null!=i?String(i):`<${n}?>`}))}(s,n):"Error",o=`${this.serviceName}: ${r} (${i}).`;return new d(i,o,n)}}const p=/\{\$([^}]+)}/g;function g(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const s of n){if(!i.includes(s))return!1;const n=e[s],r=t[s];if(m(n)&&m(r)){if(!g(n,r))return!1}else if(n!==r)return!1}for(const e of i)if(!n.includes(e))return!1;return!0}function m(e){return null!==e&&"object"==typeof e}function y(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function v(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}})),t}function w(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class I{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=b),void 0===i.error&&(i.error=b),void 0===i.complete&&(i.complete=b);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}})),this.observers.push(i),s}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function b(){}function E(e,t=1e3,n=2){const i=t*Math.pow(n,e),s=Math.round(.5*i*(Math.random()-.5)*2);return Math.min(144e5,i+s)}function _(e){return e&&e._delegate?e._delegate:e}class T{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const S="[DEFAULT]";class C{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new s;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),i=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(i)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:S})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e="[DEFAULT]"){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e="[DEFAULT]"){return this.instances.has(e)}getOptions(e="[DEFAULT]"){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&e(r,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===S?void 0:i),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var i;return n||null}normalizeInstanceIdentifier(e="[DEFAULT]"){return this.component?this.component.multipleInstances?e:S:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class k{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new C(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const A=[];var N,R;(R=N||(N={}))[R.DEBUG=0]="DEBUG",R[R.VERBOSE=1]="VERBOSE",R[R.INFO=2]="INFO",R[R.WARN=3]="WARN",R[R.ERROR=4]="ERROR",R[R.SILENT=5]="SILENT";const D={debug:N.DEBUG,verbose:N.VERBOSE,info:N.INFO,warn:N.WARN,error:N.ERROR,silent:N.SILENT},O=N.INFO,P={[N.DEBUG]:"log",[N.VERBOSE]:"log",[N.INFO]:"info",[N.WARN]:"warn",[N.ERROR]:"error"},L=(e,t,...n)=>{if(t<e.logLevel)return;const i=(new Date).toISOString(),s=P[t];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[s](`[${i}]  ${e.name}:`,...n)};class M{constructor(e){this.name=e,this._logLevel=O,this._logHandler=L,this._userLogHandler=null,A.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in N))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?D[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,N.DEBUG,...e),this._logHandler(this,N.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,N.VERBOSE,...e),this._logHandler(this,N.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,N.INFO,...e),this._logHandler(this,N.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,N.WARN,...e),this._logHandler(this,N.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,N.ERROR,...e),this._logHandler(this,N.ERROR,...e)}}let x,F;const U=new WeakMap,V=new WeakMap,j=new WeakMap,B=new WeakMap,q=new WeakMap;let $={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return V.get(e);if("objectStoreNames"===t)return e.objectStoreNames||j.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return K(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function z(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(F||(F=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(H(this),e),K(U.get(this))}:function(...e){return K(t.apply(H(this),e))}:function(e,...n){const i=t.call(H(this),e,...n);return j.set(i,e.sort?e.sort():[e]),K(i)}:(e instanceof IDBTransaction&&function(e){if(V.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",r),e.removeEventListener("abort",r)},s=()=>{t(),i()},r=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",r),e.addEventListener("abort",r)}));V.set(e,t)}(e),n=e,(x||(x=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>n instanceof e))?new Proxy(e,$):e);var t,n}function K(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",r)},s=()=>{t(K(e.result)),i()},r=()=>{n(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",r)}));return t.then((t=>{t instanceof IDBCursor&&U.set(t,e)})).catch((()=>{})),q.set(t,e),t}(e);if(B.has(e))return B.get(e);const t=z(e);return t!==e&&(B.set(e,t),q.set(t,e)),t}const H=e=>q.get(e);function G(e,t,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(e,t),a=K(o);return i&&o.addEventListener("upgradeneeded",(e=>{i(K(o.result),e.oldVersion,e.newVersion,K(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((e=>{r&&e.addEventListener("close",(()=>r())),s&&e.addEventListener("versionchange",(()=>s()))})).catch((()=>{})),a}const W=["get","getKey","getAll","getAllKeys","count"],Q=["put","add","delete","clear"],X=new Map;function J(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(X.get(t))return X.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,s=Q.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!W.includes(n))return;const r=async function(e,...t){const r=this.transaction(e,s?"readwrite":"readonly");let o=r.store;return i&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),s&&r.done]))[0]};return X.set(t,r),r}var Y;Y=$,$={...Y,get:(e,t,n)=>J(e,t)||Y.get(e,t,n),has:(e,t)=>!!J(e,t)||Y.has(e,t)};class Z{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const ee="@firebase/app",te="0.7.28",ne=new M("@firebase/app"),ie={[ee]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},se=new Map,re=new Map;function oe(e,t){try{e.container.addComponent(t)}catch(n){ne.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function ae(e){const t=e.name;if(re.has(t))return ne.debug(`There were multiple attempts to register component ${t}.`),!1;re.set(t,e);for(const t of se.values())oe(t,e);return!0}function ce(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const ue=new f("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."});class he{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new T("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ue.create("app-deleted",{appName:this._name})}}const le="9.9.0";function de(e="[DEFAULT]"){const t=se.get(e);if(!t)throw ue.create("no-app",{appName:e});return t}function fe(e,t,n){var i;let s=null!==(i=ie[e])&&void 0!==i?i:e;n&&(s+=`-${n}`);const r=s.match(/\s|\//),o=t.match(/\s|\//);if(r||o){const e=[`Unable to register library "${s}" with version "${t}":`];return r&&e.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void ne.warn(e.join(" "))}ae(new T(`${s}-version`,(()=>({library:s,version:t})),"VERSION"))}const pe="firebase-heartbeat-store";let ge=null;function me(){return ge||(ge=G("firebase-heartbeat-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(pe)}}).catch((e=>{throw ue.create("storage-open",{originalErrorMessage:e.message})}))),ge}async function ye(e,t){var n;try{const n=(await me()).transaction(pe,"readwrite"),i=n.objectStore(pe);return await i.put(t,ve(e)),n.done}catch(e){throw ue.create("storage-set",{originalErrorMessage:null===(n=e)||void 0===n?void 0:n.message})}}function ve(e){return`${e.name}!${e.options.appId}`}class we{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new be(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=Ie();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=Ie(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let i=e.slice();for(const s of e){const e=n.find((e=>e.agent===s.agent));if(e){if(e.dates.push(s.date),Ee(n)>t){e.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ee(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),s=i(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Ie(){return(new Date).toISOString().substring(0,10)}class be{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!h()&&l().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){var t;try{return(await me()).transaction(pe).objectStore(pe).get(ve(e))}catch(e){throw ue.create("storage-get",{originalErrorMessage:null===(t=e)||void 0===t?void 0:t.message})}}(this.app);return e||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ye(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ye(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Ee(e){return i(JSON.stringify({version:2,heartbeats:e})).length}ae(new T("platform-logger",(e=>new Z(e)),"PRIVATE")),ae(new T("heartbeat",(e=>new we(e)),"PRIVATE")),fe(ee,te,""),fe(ee,te,"esm2017"),fe("fire-js",""),fe("firebase","9.9.0","app");const _e="@firebase/installations",Te="0.5.12",Se="w:0.5.12",Ce=new f("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function ke(e){return e instanceof d&&e.code.includes("request-failed")}function Ae({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function Ne(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function Re(e,t){const n=(await t.json()).error;return Ce.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function De({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function Oe(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Pe(e){return new Promise((t=>{setTimeout(t,e)}))}const Le=/^[cdef][\w-]{21}$/;function Me(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var t}(e);return Le.test(t)?t:""}catch(e){return""}}function xe(e){return`${e.appName}!${e.appId}`}const Fe=new Map;function Ue(e,t){const n=xe(e);Ve(n,t),function(e,t){const n=(!je&&"BroadcastChannel"in self&&(je=new BroadcastChannel("[Firebase] FID Change"),je.onmessage=e=>{Ve(e.data.key,e.data.fid)}),je);n&&n.postMessage({key:e,fid:t}),0===Fe.size&&je&&(je.close(),je=null)}(n,t)}function Ve(e,t){const n=Fe.get(e);if(n)for(const e of n)e(t)}let je=null;const Be="firebase-installations-store";let qe=null;function $e(){return qe||(qe=G("firebase-installations-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(Be)}})),qe}async function ze(e,t){const n=xe(e),i=(await $e()).transaction(Be,"readwrite"),s=i.objectStore(Be),r=await s.get(n);return await s.put(t,n),await i.done,r&&r.fid===t.fid||Ue(e,t.fid),t}async function Ke(e){const t=xe(e),n=(await $e()).transaction(Be,"readwrite");await n.objectStore(Be).delete(t),await n.done}async function He(e,t){const n=xe(e),i=(await $e()).transaction(Be,"readwrite"),s=i.objectStore(Be),r=await s.get(n),o=t(r);return void 0===o?await s.delete(n):await s.put(o,n),await i.done,!o||r&&r.fid===o.fid||Ue(e,o.fid),o}async function Ge(e){let t;const n=await He(e.appConfig,(n=>{const i=function(e){return Xe(e||{fid:Me(),registrationStatus:0})}(n),s=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(Ce.create("app-offline"))};const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(e,t){try{const n=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const i=Ae(e),s=De(e),r=t.getImmediate({optional:!0});if(r){const e=await r.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const o={fid:n,authVersion:"FIS_v2",appId:e.appId,sdkVersion:Se},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await Oe((()=>fetch(i,a)));if(c.ok){const e=await c.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:Ne(e.authToken)}}throw await Re("Create Installation",c)}(e,t);return ze(e.appConfig,n)}catch(n){throw ke(n)&&409===n.customData.serverCode?await Ke(e.appConfig):await ze(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:i}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:We(e)}:{installationEntry:t}}(e,i);return t=s.registrationPromise,s.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function We(e){let t=await Qe(e.appConfig);for(;1===t.registrationStatus;)await Pe(100),t=await Qe(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await Ge(e);return n||t}return t}function Qe(e){return He(e,(e=>{if(!e)throw Ce.create("installation-not-found");return Xe(e)}))}function Xe(e){return 1===(t=e).registrationStatus&&t.registrationTime+1e4<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Je({appConfig:e,heartbeatServiceProvider:t},n){const i=function(e,{fid:t}){return`${Ae(e)}/${t}/authTokens:generate`}(e,n),s=function(e,{refreshToken:t}){const n=De(e);return n.append("Authorization",function(e){return`FIS_v2 ${e}`}(t)),n}(e,n),r=t.getImmediate({optional:!0});if(r){const e=await r.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const o={installation:{sdkVersion:Se,appId:e.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await Oe((()=>fetch(i,a)));if(c.ok)return Ne(await c.json());throw await Re("Generate Auth Token",c)}async function Ye(e,t=!1){let n;const i=await He(e.appConfig,(i=>{if(!et(i))throw Ce.create("not-registered");const s=i.authToken;if(!t&&(2===(r=s).requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(r)))return i;var r;if(1===s.requestStatus)return n=async function(e,t){let n=await Ze(e.appConfig);for(;1===n.authToken.requestStatus;)await Pe(100),n=await Ze(e.appConfig);const i=n.authToken;return 0===i.requestStatus?Ye(e,t):i}(e,t),i;{if(!navigator.onLine)throw Ce.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(i);return n=async function(e,t){try{const n=await Je(e,t),i=Object.assign(Object.assign({},t),{authToken:n});return await ze(e.appConfig,i),n}catch(n){if(!ke(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await ze(e.appConfig,n)}else await Ke(e.appConfig);throw n}}(e,t),t}}));return n?await n:i.authToken}function Ze(e){return He(e,(e=>{if(!et(e))throw Ce.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+1e4<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var t}))}function et(e){return void 0!==e&&2===e.registrationStatus}function tt(e){return Ce.create("missing-app-config-values",{valueName:e})}const nt="installations";ae(new T(nt,(e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw tt("App Configuration");if(!e.name)throw tt("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw tt(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:ce(t,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),ae(new T("installations-internal",(e=>{const t=ce(e.getProvider("app").getImmediate(),nt).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:i}=await Ge(t);return i?i.catch(console.error):Ye(t).catch(console.error),n.fid}(t),getToken:e=>async function(e,t=!1){const n=e;return await async function(e){const{registrationPromise:t}=await Ge(e);t&&await t}(n),(await Ye(n,t)).token}(t,e)}}),"PRIVATE")),fe(_e,Te),fe(_e,Te,"esm2017");const it="analytics",st="https://www.googletagmanager.com/gtag/js",rt=new M("@firebase/analytics");function ot(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}const at=new f("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),ct=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function ut(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function ht(e,t=ct,n){const{appId:i,apiKey:s,measurementId:r}=e.options;if(!i)throw at.create("no-app-id");if(!s){if(r)return{measurementId:r,appId:i};throw at.create("no-api-key")}const o=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new dt;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),lt({appId:i,apiKey:s,measurementId:r},o,a,t)}async function lt(e,{throttleEndTimeMillis:t,backoffCount:n},i,s=ct){var r,o;const{appId:a,measurementId:c}=e;try{await function(e,t){return new Promise(((n,i)=>{const s=Math.max(t-Date.now(),0),r=setTimeout(n,s);e.addEventListener((()=>{clearTimeout(r),i(at.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(i,t)}catch(e){if(c)return rt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${null===(r=e)||void 0===r?void 0:r.message}]`),{appId:a,measurementId:c};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:i}=e,s={method:"GET",headers:ut(i)},r="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(r,s);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw at.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return s.deleteThrottleMetadata(a),t}catch(t){const r=t;if(!function(e){if(!(e instanceof d&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(r)){if(s.deleteThrottleMetadata(a),c)return rt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${null==r?void 0:r.message}]`),{appId:a,measurementId:c};throw t}const u=503===Number(null===(o=null==r?void 0:r.customData)||void 0===o?void 0:o.httpStatus)?E(n,s.intervalMillis,30):E(n,s.intervalMillis),h={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return s.setThrottleMetadata(a,h),rt.debug(`Calling attemptFetch again in ${u} millis`),lt(e,h,i,s)}}class dt{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let ft,pt;async function gt(e,t,n,i,s,r,o){var a;const c=ht(e);c.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&rt.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>rt.error(e))),t.push(c);const u=async function(){var e;if(!h())return rt.warn(at.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await l()}catch(t){return rt.warn(at.create("indexeddb-unavailable",{errorInfo:null===(e=t)||void 0===e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?i.getId():void 0)),[d,f]=await Promise.all([c,u]);(function(){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(st))return t;return null})()||function(e,t){const n=document.createElement("script");n.src=`${st}?l=${e}&id=${t}`,n.async=!0,document.head.appendChild(n)}(r,d.measurementId),pt&&(s("consent","default",pt),pt=void 0),s("js",new Date);const p=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return p.origin="firebase",p.update=!0,null!=f&&(p.firebase_id=f),s("config",d.measurementId,p),ft&&(s("set",ft),ft=void 0),d.measurementId}class mt{constructor(e){this.app=e}_delete(){return delete yt[this.app.options.appId],Promise.resolve()}}let yt={},vt=[];const wt={};let It,bt,Et="dataLayer",_t=!1;function Tt(e,t,n){!function(){const e=[];if(a()&&e.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=at.create("invalid-analytics-context",{errorInfo:t});rt.warn(n.message)}}();const i=e.options.appId;if(!i)throw at.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw at.create("no-api-key");rt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=yt[i])throw at.create("already-exists",{id:i});if(!_t){!function(e){let t=[];Array.isArray(window.dataLayer)?t=window.dataLayer:window.dataLayer=t}();const{wrappedGtag:e,gtagCore:t}=function(e,t,n,i,s){let r=function(...e){window.dataLayer.push(arguments)};return window.gtag&&"function"==typeof window.gtag&&(r=window.gtag),window.gtag=function(e,t,n,i){return async function(s,r,o){try{"event"===s?await async function(e,t,n,i,s){try{let r=[];if(s&&s.send_to){let e=s.send_to;Array.isArray(e)||(e=[e]);const i=await ot(n);for(const n of e){const e=i.find((e=>e.measurementId===n)),s=e&&t[e.appId];if(!s){r=[];break}r.push(s)}}0===r.length&&(r=Object.values(t)),await Promise.all(r),e("event",i,s||{})}catch(e){rt.error(e)}}(e,t,n,r,o):"config"===s?await async function(e,t,n,i,s,r){const o=i[s];try{if(o)await t[o];else{const e=(await ot(n)).find((e=>e.measurementId===s));e&&await t[e.appId]}}catch(e){rt.error(e)}e("config",s,r)}(e,t,n,i,r,o):"consent"===s?e("consent","update",o):e("set",r)}catch(e){rt.error(e)}}}(r,e,t,n),{gtagCore:r,wrappedGtag:window.gtag}}(yt,vt,wt);bt=e,It=t,_t=!0}return yt[i]=gt(e,vt,wt,t,It,Et,n),new mt(e)}const St="@firebase/analytics",Ct="0.8.0";ae(new T(it,((e,{options:t})=>Tt(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),ae(new T("analytics-internal",(function(e){try{const t=e.getProvider(it).getImmediate();return{logEvent:(e,n,i)=>function(e,t,n,i){e=_(e),async function(e,t,n,i,s){if(s&&s.global)e("event",n,i);else{const s=await t;e("event",n,Object.assign(Object.assign({},i),{send_to:s}))}}(bt,yt[e.app.options.appId],t,n,i).catch((e=>rt.error(e)))}(t,e,n,i)}}catch(e){throw at.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),fe(St,Ct),fe(St,Ct,"esm2017");var kt,At="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e.g?e.g:"undefined"!=typeof self?self:{},Nt={},Rt=Rt||{},Dt=At||self;function Ot(){}function Pt(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function Lt(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Mt="closure_uid_"+(1e9*Math.random()>>>0),xt=0;function Ft(e,t,n){return e.call.apply(e.bind,arguments)}function Ut(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Vt(e,t,n){return(Vt=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ft:Ut).apply(null,arguments)}function jt(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Bt(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,i){for(var s=Array(arguments.length-2),r=2;r<arguments.length;r++)s[r-2]=arguments[r];return t.prototype[n].apply(e,s)}}function qt(){this.s=this.s,this.o=this.o}var $t={};qt.prototype.s=!1,qt.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,Mt)&&e[Mt]||(e[Mt]=++xt)}(this);delete $t[e]}},qt.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const zt=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},Kt=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){const i=e.length,s="string"==typeof e?e.split(""):e;for(let r=0;r<i;r++)r in s&&t.call(n,s[r],r,e)};function Ht(e){return Array.prototype.concat.apply([],arguments)}function Gt(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function Wt(e){return/^[\s\xa0]*$/.test(e)}var Qt,Xt=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Jt(e,t){return-1!=e.indexOf(t)}function Yt(e,t){return e<t?-1:e>t?1:0}e:{var Zt=Dt.navigator;if(Zt){var en=Zt.userAgent;if(en){Qt=en;break e}}Qt=""}function tn(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function nn(e){const t={};for(const n in e)t[n]=e[n];return t}var sn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rn(e,t){let n,i;for(let t=1;t<arguments.length;t++){for(n in i=arguments[t],i)e[n]=i[n];for(let t=0;t<sn.length;t++)n=sn[t],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function on(e){return on[" "](e),e}on[" "]=Ot;var an,cn,un=Jt(Qt,"Opera"),hn=Jt(Qt,"Trident")||Jt(Qt,"MSIE"),ln=Jt(Qt,"Edge"),dn=ln||hn,fn=Jt(Qt,"Gecko")&&!(Jt(Qt.toLowerCase(),"webkit")&&!Jt(Qt,"Edge"))&&!(Jt(Qt,"Trident")||Jt(Qt,"MSIE"))&&!Jt(Qt,"Edge"),pn=Jt(Qt.toLowerCase(),"webkit")&&!Jt(Qt,"Edge");function gn(){var e=Dt.document;return e?e.documentMode:void 0}e:{var mn="",yn=(cn=Qt,fn?/rv:([^\);]+)(\)|;)/.exec(cn):ln?/Edge\/([\d\.]+)/.exec(cn):hn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(cn):pn?/WebKit\/(\S+)/.exec(cn):un?/(?:Version)[ \/]?(\S+)/.exec(cn):void 0);if(yn&&(mn=yn?yn[1]:""),hn){var vn=gn();if(null!=vn&&vn>parseFloat(mn)){an=String(vn);break e}}an=mn}var wn,In={};function bn(){return e=In,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){let e=0;const t=Xt(String(an)).split("."),n=Xt("9").split("."),i=Math.max(t.length,n.length);for(let o=0;0==e&&o<i;o++){var s=t[o]||"",r=n[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],0==s[0].length&&0==r[0].length)break;e=Yt(0==s[1].length?0:parseInt(s[1],10),0==r[1].length?0:parseInt(r[1],10))||Yt(0==s[2].length,0==r[2].length)||Yt(s[2],r[2]),s=s[3],r=r[3]}while(0==e)}return 0<=e}();var e}Dt.document&&hn?wn=gn()||parseInt(an,10)||void 0:wn=void 0;var En=wn,_n=function(){if(!Dt.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Dt.addEventListener("test",Ot,t),Dt.removeEventListener("test",Ot,t)}catch(e){}return e}();function Tn(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function Sn(e,t){if(Tn.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(fn){e:{try{on(t.nodeName);var s=!0;break e}catch(e){}s=!1}s||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Cn[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Sn.Z.h.call(this)}}Tn.prototype.h=function(){this.defaultPrevented=!0},Bt(Sn,Tn);var Cn={2:"touch",3:"pen",4:"mouse"};Sn.prototype.h=function(){Sn.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var kn="closure_listenable_"+(1e6*Math.random()|0),An=0;function Nn(e,t,n,i,s){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.ia=s,this.key=++An,this.ca=this.fa=!1}function Rn(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function Dn(e){this.src=e,this.g={},this.h=0}function On(e,t){var n=t.type;if(n in e.g){var i,s=e.g[n],r=zt(s,t);(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(Rn(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Pn(e,t,n,i){for(var s=0;s<e.length;++s){var r=e[s];if(!r.ca&&r.listener==t&&r.capture==!!n&&r.ia==i)return s}return-1}Dn.prototype.add=function(e,t,n,i,s){var r=e.toString();(e=this.g[r])||(e=this.g[r]=[],this.h++);var o=Pn(e,t,i,s);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new Nn(t,this.src,r,!!i,s)).fa=n,e.push(t)),t};var Ln="closure_lm_"+(1e6*Math.random()|0),Mn={};function xn(e,t,n,i,s){if(i&&i.once)return Un(e,t,n,i,s);if(Array.isArray(t)){for(var r=0;r<t.length;r++)xn(e,t[r],n,i,s);return null}return n=Kn(n),e&&e[kn]?e.N(t,n,Lt(i)?!!i.capture:!!i,s):Fn(e,t,n,!1,i,s)}function Fn(e,t,n,i,s,r){if(!t)throw Error("Invalid event type");var o=Lt(s)?!!s.capture:!!s,a=$n(e);if(a||(e[Ln]=a=new Dn(e)),(n=a.add(t,n,i,o,r)).proxy)return n;if(i=function(){var e=qn;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)_n||(s=o),void 0===s&&(s=!1),e.addEventListener(t.toString(),i,s);else if(e.attachEvent)e.attachEvent(Bn(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}function Un(e,t,n,i,s){if(Array.isArray(t)){for(var r=0;r<t.length;r++)Un(e,t[r],n,i,s);return null}return n=Kn(n),e&&e[kn]?e.O(t,n,Lt(i)?!!i.capture:!!i,s):Fn(e,t,n,!0,i,s)}function Vn(e,t,n,i,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)Vn(e,t[r],n,i,s);else i=Lt(i)?!!i.capture:!!i,n=Kn(n),e&&e[kn]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=Pn(r=e.g[t],n,i,s))&&(Rn(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete e.g[t],e.h--))):e&&(e=$n(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Pn(t,n,i,s)),(n=-1<e?t[e]:null)&&jn(n))}function jn(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[kn])On(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(Bn(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=$n(t))?(On(n,e),0==n.h&&(n.src=null,t[Ln]=null)):Rn(e)}}}function Bn(e){return e in Mn?Mn[e]:Mn[e]="on"+e}function qn(e,t){if(e.ca)e=!0;else{t=new Sn(t,this);var n=e.listener,i=e.ia||e.src;e.fa&&jn(e),e=n.call(i,t)}return e}function $n(e){return(e=e[Ln])instanceof Dn?e:null}var zn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Kn(e){return"function"==typeof e?e:(e[zn]||(e[zn]=function(t){return e.handleEvent(t)}),e[zn])}function Hn(){qt.call(this),this.i=new Dn(this),this.P=this,this.I=null}function Gn(e,t){var n,i=e.I;if(i)for(n=[];i;i=i.I)n.push(i);if(e=e.P,i=t.type||t,"string"==typeof t)t=new Tn(t,e);else if(t instanceof Tn)t.target=t.target||e;else{var s=t;rn(t=new Tn(i,e),s)}if(s=!0,n)for(var r=n.length-1;0<=r;r--){var o=t.g=n[r];s=Wn(o,i,!0,t)&&s}if(s=Wn(o=t.g=e,i,!0,t)&&s,s=Wn(o,i,!1,t)&&s,n)for(r=0;r<n.length;r++)s=Wn(o=t.g=n[r],i,!1,t)&&s}function Wn(e,t,n,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,r=0;r<t.length;++r){var o=t[r];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&On(e.i,o),s=!1!==a.call(c,i)&&s}}return s&&!i.defaultPrevented}Bt(Hn,qt),Hn.prototype[kn]=!0,Hn.prototype.removeEventListener=function(e,t,n,i){Vn(this,e,t,n,i)},Hn.prototype.M=function(){if(Hn.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)Rn(n[i]);delete t.g[e],t.h--}}this.I=null},Hn.prototype.N=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)},Hn.prototype.O=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};var Qn=Dt.JSON.stringify;function Xn(){var e=ii;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Jn,Yn=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new Zn),(e=>e.reset()));class Zn{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function ei(e){Dt.setTimeout((()=>{throw e}),0)}function ti(e,t){Jn||function(){var e=Dt.Promise.resolve(void 0);Jn=function(){e.then(si)}}(),ni||(Jn(),ni=!0),ii.add(e,t)}var ni=!1,ii=new class{constructor(){this.h=this.g=null}add(e,t){const n=Yn.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}};function si(){for(var e;e=Xn();){try{e.h.call(e.g)}catch(e){ei(e)}var t=Yn;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}ni=!1}function ri(e,t){Hn.call(this),this.h=e||1,this.g=t||Dt,this.j=Vt(this.kb,this),this.l=Date.now()}function oi(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function ai(e,t,n){if("function"==typeof e)n&&(e=Vt(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Vt(e.handleEvent,e)}return 2147483647<Number(t)?-1:Dt.setTimeout(e,t||0)}function ci(e){e.g=ai((()=>{e.g=null,e.i&&(e.i=!1,ci(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}Bt(ri,Hn),(kt=ri.prototype).da=!1,kt.S=null,kt.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Gn(this,"tick"),this.da&&(oi(this),this.start()))}},kt.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},kt.M=function(){ri.Z.M.call(this),oi(this),delete this.g};class ui extends qt{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:ci(this)}M(){super.M(),this.g&&(Dt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hi(e){qt.call(this),this.h=e,this.g={}}Bt(hi,qt);var li=[];function di(e,t,n,i){Array.isArray(n)||(n&&(li[0]=n.toString()),n=li);for(var s=0;s<n.length;s++){var r=xn(t,n[s],i||e.handleEvent,!1,e.h||e);if(!r)break;e.g[r.key]=r}}function fi(e){tn(e.g,(function(e,t){this.g.hasOwnProperty(t)&&jn(e)}),e),e.g={}}function pi(){this.g=!0}function gi(e,t,n,i){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var s=i[1];if(Array.isArray(s)&&!(1>s.length)){var r=s[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<s.length;o++)s[o]=""}}}return Qn(n)}catch(e){return t}}(e,n)+(i?" "+i:"")}))}hi.prototype.M=function(){hi.Z.M.call(this),fi(this)},hi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pi.prototype.Aa=function(){this.g=!1},pi.prototype.info=function(){};var mi={},yi=null;function vi(){return yi=yi||new Hn}function wi(e){Tn.call(this,mi.Ma,e)}function Ii(e){const t=vi();Gn(t,new wi(t,e))}function bi(e,t){Tn.call(this,mi.STAT_EVENT,e),this.stat=t}function Ei(e){const t=vi();Gn(t,new bi(t,e))}function _i(e,t){Tn.call(this,mi.Na,e),this.size=t}function Ti(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return Dt.setTimeout((function(){e()}),t)}mi.Ma="serverreachability",Bt(wi,Tn),mi.STAT_EVENT="statevent",Bt(bi,Tn),mi.Na="timingevent",Bt(_i,Tn);var Si={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Ci={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function ki(){}function Ai(e){return e.h||(e.h=e.i())}function Ni(){}ki.prototype.h=null;var Ri,Di={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Oi(){Tn.call(this,"d")}function Pi(){Tn.call(this,"c")}function Li(){}function Mi(e,t,n,i){this.l=e,this.j=t,this.m=n,this.X=i||1,this.V=new hi(this),this.P=Fi,e=dn?125:void 0,this.W=new ri(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new xi}function xi(){this.i=null,this.g="",this.h=!1}Bt(Oi,Tn),Bt(Pi,Tn),Bt(Li,ki),Li.prototype.g=function(){return new XMLHttpRequest},Li.prototype.i=function(){return{}},Ri=new Li;var Fi=45e3,Ui={},Vi={};function ji(e,t,n){e.K=1,e.v=us(is(t)),e.s=n,e.U=!0,Bi(e,null)}function Bi(e,t){e.F=Date.now(),Ki(e),e.A=is(e.v);var n=e.A,i=e.X;Array.isArray(i)||(i=[String(i)]),Es(n.h,"t",i),e.C=0,n=e.l.H,e.h=new xi,e.g=Er(e.l,n?t:null,!e.s),0<e.O&&(e.L=new ui(Vt(e.Ia,e,e.g),e.O)),di(e.V,e.g,"readystatechange",e.gb),t=e.H?nn(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ii(1),function(e,t,n,i,s,r){e.info((function(){if(e.g)if(r)for(var o="",a=r.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var h=u[0];u=u[1];var l=h.split("_");o=2<=l.length&&"type"==l[1]?o+(h+"=")+u+"&":o+(h+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+i+") [attempt "+s+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.X,e.s)}function qi(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Ba}function $i(e,t,n){let i,s=!0;for(;!e.I&&e.C<n.length;){if(i=zi(e,n),i==Vi){4==t&&(e.o=4,Ei(14),s=!1),gi(e.j,e.m,null,"[Incomplete Response]");break}if(i==Ui){e.o=4,Ei(15),gi(e.j,e.m,n,"[Invalid Chunk]"),s=!1;break}gi(e.j,e.m,i,null),Xi(e,i)}qi(e)&&i!=Vi&&i!=Ui&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Ei(16),s=!1),e.i=e.i&&s,s?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),pr(t),t.L=!0,Ei(11))):(gi(e.j,e.m,n,"[Invalid Chunked Response]"),Qi(e),Wi(e))}function zi(e,t){var n=e.C,i=t.indexOf("\n",n);return-1==i?Vi:(n=Number(t.substring(n,i)),isNaN(n)?Ui:(i+=1)+n>t.length?Vi:(t=t.substr(i,n),e.C=i+n,t))}function Ki(e){e.Y=Date.now()+e.P,Hi(e,e.P)}function Hi(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ti(Vt(e.eb,e),t)}function Gi(e){e.B&&(Dt.clearTimeout(e.B),e.B=null)}function Wi(e){0==e.l.G||e.I||yr(e.l,e)}function Qi(e){Gi(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,oi(e.W),fi(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function Xi(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||As(n.i,e)))if(n.I=e.N,!e.J&&As(n.i,e)&&3==n.G){try{var i=n.Ca.g.parse(t)}catch(e){i=null}if(Array.isArray(i)&&3==i.length){var s=i;if(0==s[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;mr(n),rr(n)}fr(n),Ei(18)}}else n.ta=s[1],0<n.ta-n.U&&37500>s[2]&&n.N&&0==n.A&&!n.v&&(n.v=Ti(Vt(n.ab,n),6e3));if(1>=ks(n.i)&&n.ka){try{n.ka()}catch(e){}n.ka=void 0}}else wr(n,11)}else if((e.J||n.g==e)&&mr(n),!Wt(t))for(s=n.Ca.g.parse(t),t=0;t<s.length;t++){let u=s[t];if(n.U=u[0],u=u[1],2==n.G)if("c"==u[0]){n.J=u[1],n.la=u[2];const t=u[3];null!=t&&(n.ma=t,n.h.info("VER="+n.ma));const s=u[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));const h=u[5];null!=h&&"number"==typeof h&&0<h&&(i=1.5*h,n.K=i,n.h.info("backChannelRequestTimeoutMs_="+i)),i=n;const l=e.g;if(l){const e=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var r=i.i;!r.g&&(Jt(e,"spdy")||Jt(e,"quic")||Jt(e,"h2"))&&(r.j=r.l,r.g=new Set,r.h&&(Ns(r,r.h),r.h=null))}if(i.D){const e=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.sa=e,cs(i.F,i.D,e))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var o=e;if((i=n).oa=br(i,i.H?i.la:null,i.W),o.J){Rs(i.i,o);var a=o,c=i.K;c&&a.setTimeout(c),a.B&&(Gi(a),Ki(a)),i.g=o}else dr(i);0<n.l.length&&cr(n)}else"stop"!=u[0]&&"close"!=u[0]||wr(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?wr(n,7):sr(n):"noop"!=u[0]&&n.j&&n.j.wa(u),n.A=0)}Ii(4)}catch(e){}}function Ji(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Pt(e)||"string"==typeof e)Kt(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(Pt(e)||"string"==typeof e){n=[];for(var i=e.length,s=0;s<i;s++)n.push(s)}else for(s in n=[],i=0,e)n[i++]=s;i=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(Pt(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),s=i.length;for(var r=0;r<s;r++)t.call(void 0,i[r],n&&n[r],e)}}function Yi(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(e)if(e instanceof Yi)for(n=e.T(),i=0;i<n.length;i++)this.set(n[i],e.get(n[i]));else for(i in e)this.set(i,e[i])}function Zi(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var i=e.g[t];es(e.h,i)&&(e.g[n++]=i),t++}e.g.length=n}if(e.i!=e.g.length){var s={};for(n=t=0;t<e.g.length;)es(s,i=e.g[t])||(e.g[n++]=i,s[i]=1),t++;e.g.length=n}}function es(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(kt=Mi.prototype).setTimeout=function(e){this.P=e},kt.gb=function(e){e=e.target;const t=this.L;t&&3==Zs(e)?t.l():this.Ia(e)},kt.Ia=function(e){try{if(e==this.g)e:{const h=Zs(this.g);var t=this.g.Da();const l=this.g.ba();if(!(3>h)&&(3!=h||dn||this.g&&(this.h.h||this.g.ga()||er(this.g)))){this.I||4!=h||7==t||Ii(8==t||0>=l?3:2),Gi(this);var n=this.g.ba();this.N=n;t:if(qi(this)){var i=er(this.g);e="";var s=i.length,r=4==Zs(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Qi(this),Wi(this);var o="";break t}this.h.i=new Dt.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:r&&t==s-1});i.splice(0,s),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=200==n,function(e,t,n,i,s,r,o){e.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+s+"]: "+t+"\n"+n+"\n"+r+" "+o}))}(this.j,this.u,this.A,this.m,this.X,h,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Wt(a)){var u=a;break t}}u=null}if(!(n=u)){this.i=!1,this.o=3,Ei(12),Qi(this),Wi(this);break e}gi(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Xi(this,n)}this.U?($i(this,h,o),dn&&this.i&&3==h&&(di(this.V,this.W,"tick",this.fb),this.W.start())):(gi(this.j,this.m,o,null),Xi(this,o)),4==h&&Qi(this),this.i&&!this.I&&(4==h?yr(this.l,this):(this.i=!1,Ki(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,Ei(12)):(this.o=0,Ei(13)),Qi(this),Wi(this)}}}catch(e){}},kt.fb=function(){if(this.g){var e=Zs(this.g),t=this.g.ga();this.C<t.length&&(Gi(this),$i(this,e,t),this.i&&4!=e&&Ki(this))}},kt.cancel=function(){this.I=!0,Qi(this)},kt.eb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(Ii(3),Ei(17)),Qi(this),this.o=2,Wi(this)):Hi(this,this.Y-e)},(kt=Yi.prototype).R=function(){Zi(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},kt.T=function(){return Zi(this),this.g.concat()},kt.get=function(e,t){return es(this.h,e)?this.h[e]:t},kt.set=function(e,t){es(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},kt.forEach=function(e,t){for(var n=this.T(),i=0;i<n.length;i++){var s=n[i],r=this.get(s);e.call(t,r,s,this)}};var ts=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ns(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof ns){this.g=void 0!==t?t:e.g,ss(this,e.j),this.s=e.s,rs(this,e.i),os(this,e.m),this.l=e.l,t=e.h;var n=new vs;n.i=t.i,t.g&&(n.g=new Yi(t.g),n.h=t.h),as(this,n),this.o=e.o}else e&&(n=String(e).match(ts))?(this.g=!!t,ss(this,n[1]||"",!0),this.s=hs(n[2]||""),rs(this,n[3]||"",!0),os(this,n[4]),this.l=hs(n[5]||"",!0),as(this,n[6]||"",!0),this.o=hs(n[7]||"")):(this.g=!!t,this.h=new vs(null,this.g))}function is(e){return new ns(e)}function ss(e,t,n){e.j=n?hs(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function rs(e,t,n){e.i=n?hs(t,!0):t}function os(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function as(e,t,n){t instanceof vs?(e.h=t,function(e,t){t&&!e.j&&(ws(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Is(this,t),Es(this,n,e))}),e)),e.j=t}(e.h,e.g)):(n||(t=ls(t,ms)),e.h=new vs(t,e.g))}function cs(e,t,n){e.h.set(t,n)}function us(e){return cs(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function hs(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ls(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,ds),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ds(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}ns.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ls(t,fs,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(ls(t,fs,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(ls(n,"/"==n.charAt(0)?gs:ps,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",ls(n,ys)),e.join("")};var fs=/[#\/\?@]/g,ps=/[#\?:]/g,gs=/[#\?]/g,ms=/[#\?@]/g,ys=/#/g;function vs(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function ws(e){e.g||(e.g=new Yi,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),s=null;if(0<=i){var r=e[n].substring(0,i);s=e[n].substring(i+1)}else r=e[n];t(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Is(e,t){ws(e),t=_s(e,t),es(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,es((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&Zi(e)))}function bs(e,t){return ws(e),t=_s(e,t),es(e.g.h,t)}function Es(e,t,n){Is(e,t),0<n.length&&(e.i=null,e.g.set(_s(e,t),Gt(n)),e.h+=n.length)}function _s(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ts(e){this.l=e||Ss,e=Dt.PerformanceNavigationTiming?0<(e=Dt.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(Dt.g&&Dt.g.Ea&&Dt.g.Ea()&&Dt.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(kt=vs.prototype).add=function(e,t){ws(this),this.i=null,e=_s(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},kt.forEach=function(e,t){ws(this),this.g.forEach((function(n,i){Kt(n,(function(n){e.call(t,n,i,this)}),this)}),this)},kt.T=function(){ws(this);for(var e=this.g.R(),t=this.g.T(),n=[],i=0;i<t.length;i++)for(var s=e[i],r=0;r<s.length;r++)n.push(t[i]);return n},kt.R=function(e){ws(this);var t=[];if("string"==typeof e)bs(this,e)&&(t=Ht(t,this.g.get(_s(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=Ht(t,e[n])}return t},kt.set=function(e,t){return ws(this),this.i=null,bs(this,e=_s(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},kt.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},kt.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var i=t[n],s=encodeURIComponent(String(i));i=this.R(i);for(var r=0;r<i.length;r++){var o=s;""!==i[r]&&(o+="="+encodeURIComponent(String(i[r]))),e.push(o)}}return this.i=e.join("&")};var Ss=10;function Cs(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ks(e){return e.h?1:e.g?e.g.size:0}function As(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Ns(e,t){e.g?e.g.add(t):e.h=t}function Rs(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Ds(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return Gt(e.i)}function Os(){}function Ps(){this.g=new Os}function Ls(e,t,n){const i=n||"";try{Ji(e,(function(e,n){let s=e;Lt(e)&&(s=Qn(e)),t.push(i+n+"="+encodeURIComponent(s))}))}catch(e){throw t.push(i+"type="+encodeURIComponent("_badmap")),e}}function Ms(e,t,n,i,s){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,s(i)}catch(e){}}function xs(e){this.l=e.$b||null,this.j=e.ib||!1}function Fs(e,t){Hn.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=Us,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ts.prototype.cancel=function(){if(this.i=Ds(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}},Os.prototype.stringify=function(e){return Dt.JSON.stringify(e,void 0)},Os.prototype.parse=function(e){return Dt.JSON.parse(e,void 0)},Bt(xs,ki),xs.prototype.g=function(){return new Fs(this.l,this.j)},xs.prototype.i=function(e){return function(){return e}}({}),Bt(Fs,Hn);var Us=0;function Vs(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function js(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Bs(e)}function Bs(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(kt=Fs.prototype).open=function(e,t){if(this.readyState!=Us)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Bs(this)},kt.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||Dt).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},kt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,js(this)),this.readyState=Us},kt.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Bs(this)),this.g&&(this.readyState=3,Bs(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Dt.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Vs(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},kt.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?js(this):Bs(this),3==this.readyState&&Vs(this)}},kt.Ua=function(e){this.g&&(this.response=this.responseText=e,js(this))},kt.Ta=function(e){this.g&&(this.response=e,js(this))},kt.ha=function(){this.g&&js(this)},kt.setRequestHeader=function(e,t){this.v.append(e,t)},kt.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},kt.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Fs.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var qs=Dt.JSON.parse;function $s(e){Hn.call(this),this.headers=new Yi,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=zs,this.K=this.L=!1}Bt($s,Hn);var zs="",Ks=/^https?$/i,Hs=["POST","PUT"];function Gs(e){return"content-type"==e.toLowerCase()}function Ws(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Qs(e),Js(e)}function Qs(e){e.D||(e.D=!0,Gn(e,"complete"),Gn(e,"error"))}function Xs(e){if(e.h&&void 0!==Rt&&(!e.C[1]||4!=Zs(e)||2!=e.ba()))if(e.v&&4==Zs(e))ai(e.Fa,0,e);else if(Gn(e,"readystatechange"),4==Zs(e)){e.h=!1;try{const a=e.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===a){var s=String(e.H).match(ts)[1]||null;if(!s&&Dt.self&&Dt.self.location){var r=Dt.self.location.protocol;s=r.substr(0,r.length-1)}i=!Ks.test(s?s.toLowerCase():"")}n=i}if(n)Gn(e,"complete"),Gn(e,"success");else{e.m=6;try{var o=2<Zs(e)?e.g.statusText:""}catch(e){o=""}e.j=o+" ["+e.ba()+"]",Qs(e)}}finally{Js(e)}}}function Js(e,t){if(e.g){Ys(e);const n=e.g,i=e.C[0]?Ot:null;e.g=null,e.C=null,t||Gn(e,"ready");try{n.onreadystatechange=i}catch(e){}}}function Ys(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(Dt.clearTimeout(e.A),e.A=null)}function Zs(e){return e.g?e.g.readyState:0}function er(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case zs:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function tr(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=function(e){let t="";return tn(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):cs(e,t,n))}function nr(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function ir(e){this.za=0,this.l=[],this.h=new pi,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=nr("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=nr("baseRetryDelayMs",5e3,e),this.$a=nr("retryDelaySeedMs",1e4,e),this.Ya=nr("forwardChannelMaxRetries",2,e),this.ra=nr("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new Ts(e&&e.concurrentRequestLimit),this.Ca=new Ps,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function sr(e){if(or(e),3==e.G){var t=e.V++,n=is(e.F);cs(n,"SID",e.J),cs(n,"RID",t),cs(n,"TYPE","terminate"),hr(e,n),(t=new Mi(e,e.h,t,void 0)).K=2,t.v=us(is(n)),n=!1,Dt.navigator&&Dt.navigator.sendBeacon&&(n=Dt.navigator.sendBeacon(t.v.toString(),"")),!n&&Dt.Image&&((new Image).src=t.v,n=!0),n||(t.g=Er(t.l,null),t.g.ea(t.v)),t.F=Date.now(),Ki(t)}Ir(e)}function rr(e){e.g&&(pr(e),e.g.cancel(),e.g=null)}function or(e){rr(e),e.u&&(Dt.clearTimeout(e.u),e.u=null),mr(e),e.i.cancel(),e.m&&("number"==typeof e.m&&Dt.clearTimeout(e.m),e.m=null)}function ar(e,t){e.l.push(new class{constructor(e,t){this.h=e,this.g=t}}(e.Za++,t)),3==e.G&&cr(e)}function cr(e){Cs(e.i)||e.m||(e.m=!0,ti(e.Ha,e),e.C=0)}function ur(e,t){var n;n=t?t.m:e.V++;const i=is(e.F);cs(i,"SID",e.J),cs(i,"RID",n),cs(i,"AID",e.U),hr(e,i),e.o&&e.s&&tr(i,e.o,e.s),n=new Mi(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=lr(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),Ns(e.i,n),ji(n,i,t)}function hr(e,t){e.j&&Ji({},(function(e,n){cs(t,n,e)}))}function lr(e,t,n){n=Math.min(e.l.length,n);var i=e.j?Vt(e.j.Oa,e.j,e):null;e:{var s=e.l;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=s[0].h,e.push("ofs="+t)):t=0:e.push("ofs="+t);let r=!0;for(let o=0;o<n;o++){let n=s[o].h;const a=s[o].g;if(n-=t,0>n)t=Math.max(0,s[o].h-100),r=!1;else try{Ls(a,e,"req"+n+"_")}catch(e){i&&i(a)}}if(r){i=e.join("&");break e}}}return e=e.l.splice(0,n),t.D=e,i}function dr(e){e.g||e.u||(e.Y=1,ti(e.Ga,e),e.A=0)}function fr(e){return!(e.g||e.u||3<=e.A||(e.Y++,e.u=Ti(Vt(e.Ga,e),vr(e,e.A)),e.A++,0))}function pr(e){null!=e.B&&(Dt.clearTimeout(e.B),e.B=null)}function gr(e){e.g=new Mi(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=is(e.oa);cs(t,"RID","rpc"),cs(t,"SID",e.J),cs(t,"CI",e.N?"0":"1"),cs(t,"AID",e.U),hr(e,t),cs(t,"TYPE","xmlhttp"),e.o&&e.s&&tr(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=us(is(t)),n.s=null,n.U=!0,Bi(n,e)}function mr(e){null!=e.v&&(Dt.clearTimeout(e.v),e.v=null)}function yr(e,t){var n=null;if(e.g==t){mr(e),pr(e),e.g=null;var i=2}else{if(!As(e.i,t))return;n=t.D,Rs(e.i,t),i=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==i){n=t.s?t.s.length:0,t=Date.now()-t.F;var s=e.C;Gn(i=vi(),new _i(i,n,t,s)),cr(e)}else dr(e);else if(3==(s=t.o)||0==s&&0<e.I||!(1==i&&function(e,t){return!(ks(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=Ti(Vt(e.Ha,e,t),vr(e,e.C)),e.C++,0)))}(e,t)||2==i&&fr(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),s){case 1:wr(e,5);break;case 4:wr(e,10);break;case 3:wr(e,6);break;default:wr(e,2)}}function vr(e,t){let n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function wr(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var i=Vt(e.jb,e);n||(n=new ns("//www.google.com/images/cleardot.gif"),Dt.location&&"http"==Dt.location.protocol||ss(n,"https"),us(n)),function(e,t){const n=new pi;if(Dt.Image){const i=new Image;i.onload=jt(Ms,n,i,"TestLoadImage: loaded",!0,t),i.onerror=jt(Ms,n,i,"TestLoadImage: error",!1,t),i.onabort=jt(Ms,n,i,"TestLoadImage: abort",!1,t),i.ontimeout=jt(Ms,n,i,"TestLoadImage: timeout",!1,t),Dt.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=e}else t(!1)}(n.toString(),i)}else Ei(2);e.G=0,e.j&&e.j.va(t),Ir(e),or(e)}function Ir(e){e.G=0,e.I=-1,e.j&&(0==Ds(e.i).length&&0==e.l.length||(e.i.i.length=0,Gt(e.l),e.l.length=0),e.j.ua())}function br(e,t,n){let i=function(e){return e instanceof ns?is(e):new ns(e,void 0)}(n);if(""!=i.i)t&&rs(i,t+"."+i.i),os(i,i.m);else{const e=Dt.location;i=function(e,t,n,i){var s=new ns(null,void 0);return e&&ss(s,e),t&&rs(s,t),n&&os(s,n),i&&(s.l=i),s}(e.protocol,t?t+"."+e.hostname:e.hostname,+e.port,n)}return e.aa&&tn(e.aa,(function(e,t){cs(i,t,e)})),t=e.D,n=e.sa,t&&n&&cs(i,t,n),cs(i,"VER",e.ma),hr(e,i),i}function Er(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ba&&!e.qa?new $s(new xs({ib:!0})):new $s(e.qa)).L=e.H,t}function _r(){}function Tr(){if(hn&&!(10<=Number(En)))throw Error("Environmental error: no available transport.")}function Sr(e,t){Hn.call(this),this.g=new ir(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!Wt(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Wt(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new Ar(this)}function Cr(e){Oi.call(this);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function kr(){Pi.call(this),this.status=1}function Ar(e){this.g=e}(kt=$s.prototype).ea=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Ri.g(),this.C=this.u?Ai(this.u):Ai(Ri),this.g.onreadystatechange=Vt(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(e){return void Ws(this,e)}e=n||"";const s=new Yi(this.headers);i&&Ji(i,(function(e,t){s.set(t,e)})),i=function(e){e:{var t=Gs;const n=e.length,i="string"==typeof e?e.split(""):e;for(let s=0;s<n;s++)if(s in i&&t.call(void 0,i[s],s,e)){t=s;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(s.T()),n=Dt.FormData&&e instanceof Dt.FormData,!(0<=zt(Hs,t))||i||n||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach((function(e,t){this.g.setRequestHeader(t,e)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Ys(this),0<this.B&&((this.K=function(e){return hn&&bn()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Vt(this.pa,this)):this.A=ai(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){Ws(this,e)}},kt.pa=function(){void 0!==Rt&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Gn(this,"timeout"),this.abort(8))},kt.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Gn(this,"complete"),Gn(this,"abort"),Js(this))},kt.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Js(this,!0)),$s.Z.M.call(this)},kt.Fa=function(){this.s||(this.F||this.v||this.l?Xs(this):this.cb())},kt.cb=function(){Xs(this)},kt.ba=function(){try{return 2<Zs(this)?this.g.status:-1}catch(e){return-1}},kt.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},kt.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),qs(t)}},kt.Da=function(){return this.m},kt.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(kt=ir.prototype).ma=8,kt.G=1,kt.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(e){}},kt.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const s=new Mi(this,this.h,e,void 0);let r=this.s;if(this.P&&(r?(r=nn(r),rn(r,this.P)):r=this.P),null===this.o&&(s.H=r),this.ja)e:{for(var t=0,n=0;n<this.l.length;n++){var i=this.l[n];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=n;break e}if(4096===t||n===this.l.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=lr(this,s,t),cs(n=is(this.F),"RID",e),cs(n,"CVER",22),this.D&&cs(n,"X-HTTP-Session-Id",this.D),hr(this,n),this.o&&r&&tr(n,this.o,r),Ns(this.i,s),this.Ra&&cs(n,"TYPE","init"),this.ja?(cs(n,"$req",t),cs(n,"SID","null"),s.$=!0,ji(s,n,null)):ji(s,n,t),this.G=2}}else 3==this.G&&(e?ur(this,e):0==this.l.length||Cs(this.i)||ur(this))},kt.Ga=function(){if(this.u=null,gr(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=Ti(Vt(this.bb,this),e)}},kt.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Ei(10),rr(this),gr(this))},kt.ab=function(){null!=this.v&&(this.v=null,rr(this),fr(this),Ei(19))},kt.jb=function(e){e?(this.h.info("Successfully pinged google.com"),Ei(2)):(this.h.info("Failed to ping google.com"),Ei(1))},(kt=_r.prototype).xa=function(){},kt.wa=function(){},kt.va=function(){},kt.ua=function(){},kt.Oa=function(){},Tr.prototype.g=function(e,t){return new Sr(e,t)},Bt(Sr,Hn),Sr.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),ti(Vt(e.hb,e,t))),Ei(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=br(e,null,e.W),cr(e)},Sr.prototype.close=function(){sr(this.g)},Sr.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,ar(this.g,t)}else this.v?((t={}).__data__=Qn(e),ar(this.g,t)):ar(this.g,e)},Sr.prototype.M=function(){this.g.j=null,delete this.j,sr(this.g),delete this.g,Sr.Z.M.call(this)},Bt(Cr,Oi),Bt(kr,Pi),Bt(Ar,_r),Ar.prototype.xa=function(){Gn(this.g,"a")},Ar.prototype.wa=function(e){Gn(this.g,new Cr(e))},Ar.prototype.va=function(e){Gn(this.g,new kr(e))},Ar.prototype.ua=function(){Gn(this.g,"b")},Tr.prototype.createWebChannel=Tr.prototype.g,Sr.prototype.send=Sr.prototype.u,Sr.prototype.open=Sr.prototype.m,Sr.prototype.close=Sr.prototype.close,Si.NO_ERROR=0,Si.TIMEOUT=8,Si.HTTP_ERROR=6,Ci.COMPLETE="complete",Ni.EventType=Di,Di.OPEN="a",Di.CLOSE="b",Di.ERROR="c",Di.MESSAGE="d",Hn.prototype.listen=Hn.prototype.N,$s.prototype.listenOnce=$s.prototype.O,$s.prototype.getLastError=$s.prototype.La,$s.prototype.getLastErrorCode=$s.prototype.Da,$s.prototype.getStatus=$s.prototype.ba,$s.prototype.getResponseJson=$s.prototype.Qa,$s.prototype.getResponseText=$s.prototype.ga,$s.prototype.send=$s.prototype.ea;var Nr=Nt.createWebChannelTransport=function(){return new Tr},Rr=Nt.getStatEventTarget=function(){return vi()},Dr=Nt.ErrorCode=Si,Or=Nt.EventType=Ci,Pr=Nt.Event=mi,Lr=Nt.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Mr=Nt.FetchXmlHttpFactory=xs,xr=Nt.WebChannel=Ni,Fr=Nt.XhrIo=$s;const Ur="@firebase/firestore";class Vr{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Vr.UNAUTHENTICATED=new Vr(null),Vr.GOOGLE_CREDENTIALS=new Vr("google-credentials-uid"),Vr.FIRST_PARTY=new Vr("first-party-uid"),Vr.MOCK_USER=new Vr("mock-user");let jr="9.9.0";const Br=new M("@firebase/firestore");function qr(){return Br.logLevel}function $r(e,...t){if(Br.logLevel<=N.DEBUG){const n=t.map(Hr);Br.debug(`Firestore (${jr}): ${e}`,...n)}}function zr(e,...t){if(Br.logLevel<=N.ERROR){const n=t.map(Hr);Br.error(`Firestore (${jr}): ${e}`,...n)}}function Kr(e,...t){if(Br.logLevel<=N.WARN){const n=t.map(Hr);Br.warn(`Firestore (${jr}): ${e}`,...n)}}function Hr(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function Gr(e="Unexpected state"){const t=`FIRESTORE (${jr}) INTERNAL ASSERTION FAILED: `+e;throw zr(t),new Error(t)}function Wr(e,t){e||Gr()}function Qr(e,t){return e}const Xr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Jr extends d{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Yr{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Zr{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class eo{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Vr.UNAUTHENTICATED)))}shutdown(){}}class to{constructor(e){this.t=e,this.currentUser=Vr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const i=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let s=new Yr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Yr,e.enqueueRetryable((()=>i(this.currentUser)))};const r=()=>{const t=s;e.enqueueRetryable((async()=>{await t.promise,await i(this.currentUser)}))},o=e=>{$r("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),r()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):($r("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Yr)}}),0),r()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?($r("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Wr("string"==typeof t.accessToken),new Zr(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Wr(null===e||"string"==typeof e),new Vr(e)}}class no{constructor(e,t,n){this.type="FirstParty",this.user=Vr.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",t);const i=e.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),n&&this.headers.set("X-Goog-Iam-Authorization-Token",n)}}class io{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new no(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable((()=>t(Vr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class so{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ro{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,t){const n=e=>{null!=e.error&&$r("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.p;return this.p=e.token,$r("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const i=e=>{$r("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.g.onInit((e=>i(e))),setTimeout((()=>{if(!this.appCheck){const e=this.g.getImmediate({optional:!0});e?i(e):$r("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Wr("string"==typeof e.token),this.p=e.token,new so(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function oo(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}function ao(e,t){return e<t?-1:e>t?1:0}function co(e,t,n){return e.length===t.length&&e.every(((e,i)=>n(e,t[i])))}class uo{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Jr(Xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Jr(Xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Jr(Xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Jr(Xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return uo.fromMillis(Date.now())}static fromDate(e){return uo.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new uo(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ao(this.nanoseconds,e.nanoseconds):ao(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class ho{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ho(e)}static min(){return new ho(new uo(0,0))}static max(){return new ho(new uo(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class lo{constructor(e,t,n){void 0===t?t=0:t>e.length&&Gr(),void 0===n?n=e.length-t:n>e.length-t&&Gr(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===lo.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof lo?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const n=e.get(i),s=t.get(i);if(n<s)return-1;if(n>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class fo extends lo{construct(e,t,n){return new fo(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Jr(Xr.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new fo(t)}static emptyPath(){return new fo([])}}const po=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class go extends lo{construct(e,t,n){return new go(e,t,n)}static isValidIdentifier(e){return po.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),go.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new go(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(0===n.length)throw new Jr(Xr.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let r=!1;for(;i<e.length;){const t=e[i];if("\\"===t){if(i+1===e.length)throw new Jr(Xr.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Jr(Xr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,i+=2}else"`"===t?(r=!r,i++):"."!==t||r?(n+=t,i++):(s(),i++)}if(s(),r)throw new Jr(Xr.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new go(t)}static emptyPath(){return new go([])}}class mo{constructor(e){this.path=e}static fromPath(e){return new mo(fo.fromString(e))}static fromName(e){return new mo(fo.fromString(e).popFirst(5))}static empty(){return new mo(fo.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===fo.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return fo.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new mo(new fo(e.slice()))}}function yo(e){return new vo(e.readTime,e.key,-1)}class vo{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new vo(ho.min(),mo.empty(),-1)}static max(){return new vo(ho.max(),mo.empty(),-1)}}function wo(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=mo.comparator(e.documentKey,t.documentKey),0!==n?n:ao(e.largestBatchId,t.largestBatchId))}async function Io(e){if(e.code!==Xr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;$r("LocalStore","Unexpectedly lost primary lease")}class bo{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Gr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new bo(((n,i)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,i)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof bo?t:bo.resolve(t)}catch(e){return bo.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):bo.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):bo.reject(t)}static resolve(e){return new bo(((t,n)=>{t(e)}))}static reject(e){return new bo(((t,n)=>{n(e)}))}static waitFor(e){return new bo(((t,n)=>{let i=0,s=0,r=!1;e.forEach((e=>{++i,e.next((()=>{++s,r&&s===i&&t()}),(e=>n(e)))})),r=!0,s===i&&t()}))}static or(e){let t=bo.resolve(!1);for(const n of e)t=t.next((e=>e?bo.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,i)=>{n.push(t.call(this,e,i))})),this.waitFor(n)}static mapArray(e,t){return new bo(((n,i)=>{const s=e.length,r=new Array(s);let o=0;for(let a=0;a<s;a++){const c=a;t(e[c]).next((e=>{r[c]=e,++o,o===s&&n(r)}),(e=>i(e)))}}))}static doWhile(e,t){return new bo(((n,i)=>{const s=()=>{!0===e()?t().next((()=>{s()}),i):n()};s()}))}}function Eo(e){return"IndexedDbTransactionError"===e.name}class _o{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.it(e),this.rt=e=>t.writeSequenceNumber(e))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}function To(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function So(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}_o.ot=-1;class Co{constructor(e,t){this.comparator=e,this.root=t||Ao.EMPTY}insert(e,t){return new Co(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ao.BLACK,null,null))}remove(e){return new Co(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ao.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ko(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ko(this.root,e,this.comparator,!1)}getReverseIterator(){return new ko(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ko(this.root,e,this.comparator,!0)}}class ko{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ao{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=null!=n?n:Ao.RED,this.left=null!=i?i:Ao.EMPTY,this.right=null!=s?s:Ao.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new Ao(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ao.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return Ao.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ao.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ao.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Gr();if(this.right.isRed())throw Gr();const e=this.left.check();if(e!==this.right.check())throw Gr();return e+(this.isRed()?0:1)}}Ao.EMPTY=null,Ao.RED=!0,Ao.BLACK=!1,Ao.EMPTY=new class{constructor(){this.size=0}get key(){throw Gr()}get value(){throw Gr()}get color(){throw Gr()}get left(){throw Gr()}get right(){throw Gr()}copy(e,t,n,i,s){return this}insert(e,t,n){return new Ao(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class No{constructor(e){this.comparator=e,this.data=new Co(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ro(this.data.getIterator())}getIteratorFrom(e){return new Ro(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof No))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new No(this.comparator);return t.data=e,t}}class Ro{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Do{constructor(e){this.fields=e,e.sort(go.comparator)}static empty(){return new Do([])}unionWith(e){let t=new No(go.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new Do(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return co(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Oo{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new Oo(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Oo(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ao(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Oo.EMPTY_BYTE_STRING=new Oo("");const Po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Lo(e){if(Wr(!!e),"string"==typeof e){let t=0;const n=Po.exec(e);if(Wr(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Mo(e.seconds),nanos:Mo(e.nanos)}}function Mo(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function xo(e){return"string"==typeof e?Oo.fromBase64String(e):Oo.fromUint8Array(e)}function Fo(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Uo(e){const t=e.mapValue.fields.__previous_value__;return Fo(t)?Uo(t):t}function Vo(e){const t=Lo(e.mapValue.fields.__local_write_time__.timestampValue);return new uo(t.seconds,t.nanos)}class jo{constructor(e,t,n,i,s,r,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=r,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class Bo{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Bo("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Bo&&e.projectId===this.projectId&&e.database===this.database}}function qo(e){return null==e}function $o(e){return 0===e&&1/e==-1/0}const zo={fields:{__type__:{stringValue:"__max__"}}};function Ko(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Fo(e)?4:sa(e)?9007199254740991:10:Gr()}function Ho(e,t){if(e===t)return!0;const n=Ko(e);if(n!==Ko(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Vo(e).isEqual(Vo(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Lo(e.timestampValue),i=Lo(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return xo(e.bytesValue).isEqual(xo(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Mo(e.geoPointValue.latitude)===Mo(t.geoPointValue.latitude)&&Mo(e.geoPointValue.longitude)===Mo(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Mo(e.integerValue)===Mo(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Mo(e.doubleValue),i=Mo(t.doubleValue);return n===i?$o(n)===$o(i):isNaN(n)&&isNaN(i)}return!1}(e,t);case 9:return co(e.arrayValue.values||[],t.arrayValue.values||[],Ho);case 10:return function(e,t){const n=e.mapValue.fields||{},i=t.mapValue.fields||{};if(To(n)!==To(i))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===i[e]||!Ho(n[e],i[e])))return!1;return!0}(e,t);default:return Gr()}}function Go(e,t){return void 0!==(e.values||[]).find((e=>Ho(e,t)))}function Wo(e,t){if(e===t)return 0;const n=Ko(e),i=Ko(t);if(n!==i)return ao(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return ao(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Mo(e.integerValue||e.doubleValue),i=Mo(t.integerValue||t.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(e,t);case 3:return Qo(e.timestampValue,t.timestampValue);case 4:return Qo(Vo(e),Vo(t));case 5:return ao(e.stringValue,t.stringValue);case 6:return function(e,t){const n=xo(e),i=xo(t);return n.compareTo(i)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),i=t.split("/");for(let e=0;e<n.length&&e<i.length;e++){const t=ao(n[e],i[e]);if(0!==t)return t}return ao(n.length,i.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=ao(Mo(e.latitude),Mo(t.latitude));return 0!==n?n:ao(Mo(e.longitude),Mo(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],i=t.values||[];for(let e=0;e<n.length&&e<i.length;++e){const t=Wo(n[e],i[e]);if(t)return t}return ao(n.length,i.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===zo&&t===zo)return 0;if(e===zo)return 1;if(t===zo)return-1;const n=e.fields||{},i=Object.keys(n),s=t.fields||{},r=Object.keys(s);i.sort(),r.sort();for(let e=0;e<i.length&&e<r.length;++e){const t=ao(i[e],r[e]);if(0!==t)return t;const o=Wo(n[i[e]],s[r[e]]);if(0!==o)return o}return ao(i.length,r.length)}(e.mapValue,t.mapValue);default:throw Gr()}}function Qo(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return ao(e,t);const n=Lo(e),i=Lo(t),s=ao(n.seconds,i.seconds);return 0!==s?s:ao(n.nanos,i.nanos)}function Xo(e){return Jo(e)}function Jo(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Lo(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?xo(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,mo.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const i of e.values||[])n?n=!1:t+=",",t+=Jo(i);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",i=!0;for(const s of t)i?i=!1:n+=",",n+=`${s}:${Jo(e.fields[s])}`;return n+"}"}(e.mapValue):Gr();var t,n}function Yo(e){return!!e&&"integerValue"in e}function Zo(e){return!!e&&"arrayValue"in e}function ea(e){return!!e&&"nullValue"in e}function ta(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function na(e){return!!e&&"mapValue"in e}function ia(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return So(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=ia(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=ia(e.arrayValue.values[n]);return t}return Object.assign({},e)}function sa(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class ra{constructor(e){this.value=e}static empty(){return new ra({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!na(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ia(t)}setAll(e){let t=go.emptyPath(),n={},i=[];e.forEach(((e,s)=>{if(!t.isImmediateParentOf(s)){const e=this.getFieldsMap(t);this.applyChanges(e,n,i),n={},i=[],t=s.popLast()}e?n[s.lastSegment()]=ia(e):i.push(s.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());na(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ho(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];na(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){So(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new ra(ia(this.value))}}class oa{constructor(e,t,n,i,s,r){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.data=s,this.documentState=r}static newInvalidDocument(e){return new oa(e,0,ho.min(),ho.min(),ra.empty(),0)}static newFoundDocument(e,t,n){return new oa(e,1,t,ho.min(),n,0)}static newNoDocument(e,t){return new oa(e,2,t,ho.min(),ra.empty(),0)}static newUnknownDocument(e,t){return new oa(e,3,t,ho.min(),ra.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ra.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ra.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ho.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof oa&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new oa(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class aa{constructor(e,t=null,n=[],i=[],s=null,r=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=r,this.endAt=o,this.ut=null}}function ca(e,t=null,n=[],i=[],s=null,r=null,o=null){return new aa(e,t,n,i,s,r,o)}function ua(e){const t=Qr(e);if(null===t.ut){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>{return(t=e).field.canonicalString()+t.op.toString()+Xo(t.value);var t})).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),qo(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Xo(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Xo(e))).join(",")),t.ut=e}return t.ut}function ha(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!_a(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let s=0;s<e.filters.length;s++)if(n=e.filters[s],i=t.filters[s],n.op!==i.op||!n.field.isEqual(i.field)||!Ho(n.value,i.value))return!1;var n,i;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Sa(e.startAt,t.startAt)&&Sa(e.endAt,t.endAt)}function la(e){return mo.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class da extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,n):new fa(e,t,n):"array-contains"===t?new ya(e,n):"in"===t?new va(e,n):"not-in"===t?new wa(e,n):"array-contains-any"===t?new Ia(e,n):new da(e,t,n)}static ct(e,t,n){return"in"===t?new pa(e,n):new ga(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(Wo(t,this.value)):null!==t&&Ko(this.value)===Ko(t)&&this.at(Wo(t,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Gr()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class fa extends da{constructor(e,t,n){super(e,t,n),this.key=mo.fromName(n.referenceValue)}matches(e){const t=mo.comparator(e.key,this.key);return this.at(t)}}class pa extends da{constructor(e,t){super(e,"in",t),this.keys=ma(0,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class ga extends da{constructor(e,t){super(e,"not-in",t),this.keys=ma(0,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ma(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>mo.fromName(e.referenceValue)))}class ya extends da{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Zo(t)&&Go(t.arrayValue,this.value)}}class va extends da{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Go(this.value.arrayValue,t)}}class wa extends da{constructor(e,t){super(e,"not-in",t)}matches(e){if(Go(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Go(this.value.arrayValue,t)}}class Ia extends da{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Zo(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Go(this.value.arrayValue,e)))}}class ba{constructor(e,t){this.position=e,this.inclusive=t}}class Ea{constructor(e,t="asc"){this.field=e,this.dir=t}}function _a(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function Ta(e,t,n){let i=0;for(let s=0;s<e.position.length;s++){const r=t[s],o=e.position[s];if(i=r.field.isKeyField()?mo.comparator(mo.fromName(o.referenceValue),n.key):Wo(o,n.data.field(r.field)),"desc"===r.dir&&(i*=-1),0!==i)break}return i}function Sa(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Ho(e.position[n],t.position[n]))return!1;return!0}class Ca{constructor(e,t=null,n=[],i=[],s=null,r="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=r,this.startAt=o,this.endAt=a,this.lt=null,this.ft=null,this.startAt,this.endAt}}function ka(e){return new Ca(e)}function Aa(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Na(e){for(const t of e.filters)if(t.ht())return t.field;return null}function Ra(e){const t=Qr(e);if(null===t.lt){t.lt=[];const e=Na(t),n=Aa(t);if(null!==e&&null===n)e.isKeyField()||t.lt.push(new Ea(e)),t.lt.push(new Ea(go.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.lt.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.lt.push(new Ea(go.keyField(),e))}}}return t.lt}function Da(e){const t=Qr(e);if(!t.ft)if("F"===t.limitType)t.ft=ca(t.path,t.collectionGroup,Ra(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const n of Ra(t)){const t="desc"===n.dir?"asc":"desc";e.push(new Ea(n.field,t))}const n=t.endAt?new ba(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new ba(t.startAt.position,t.startAt.inclusive):null;t.ft=ca(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}return t.ft}function Oa(e,t,n){return new Ca(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Pa(e,t){return ha(Da(e),Da(t))&&e.limitType===t.limitType}function La(e){return`${ua(Da(e))}|lt:${e.limitType}`}function Ma(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>{return`${(t=e).field.canonicalString()} ${t.op} ${Xo(t.value)}`;var t})).join(", ")}]`),qo(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Xo(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Xo(e))).join(",")),`Target(${t})`}(Da(e))}; limitType=${e.limitType})`}function xa(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):mo.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of e.explicitOrderBy)if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const i=Ta(e,t,n);return e.inclusive?i<=0:i<0}(e.startAt,Ra(e),t)||e.endAt&&!function(e,t,n){const i=Ta(e,t,n);return e.inclusive?i>=0:i>0}(e.endAt,Ra(e),t))}(e,t)}function Fa(e){return(t,n)=>{let i=!1;for(const s of Ra(e)){const e=Ua(s,t,n);if(0!==e)return e;i=i||s.field.isKeyField()}return 0}}function Ua(e,t,n){const i=e.field.isKeyField()?mo.comparator(t.key,n.key):function(e,t,n){const i=t.data.field(e),s=n.data.field(e);return null!==i&&null!==s?Wo(i,s):Gr()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return Gr()}}class Va{constructor(){this._=void 0}}function ja(e,t,n){return e instanceof qa?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof $a?za(e,t):e instanceof Ka?Ha(e,t):function(e,t){const n=function(e,t){return e instanceof Ga?Yo(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}(e,t),i=Wa(n)+Wa(e._t);return Yo(n)&&Yo(e._t)?function(e){return{integerValue:""+e}}(i):function(e,t){if(e.dt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$o(t)?"-0":t}}(e.wt,i)}(e,t)}function Ba(e,t,n){return e instanceof $a?za(e,t):e instanceof Ka?Ha(e,t):n}class qa extends Va{}class $a extends Va{constructor(e){super(),this.elements=e}}function za(e,t){const n=Qa(t);for(const t of e.elements)n.some((e=>Ho(e,t)))||n.push(t);return{arrayValue:{values:n}}}class Ka extends Va{constructor(e){super(),this.elements=e}}function Ha(e,t){let n=Qa(t);for(const t of e.elements)n=n.filter((e=>!Ho(e,t)));return{arrayValue:{values:n}}}class Ga extends Va{constructor(e,t){super(),this.wt=e,this._t=t}}function Wa(e){return Mo(e.integerValue||e.doubleValue)}function Qa(e){return Zo(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Xa{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Xa}static exists(e){return new Xa(void 0,e)}static updateTime(e){return new Xa(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ja(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Ya{}function Za(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new cc(e.key,Xa.none()):new ic(e.key,e.data,Xa.none());{const n=e.data,i=ra.empty();let s=new No(go.comparator);for(let e of t.fields)if(!s.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?i.delete(e):i.set(e,t),s=s.add(e)}return new sc(e.key,i,new Do(s.toArray()),Xa.none())}}function ec(e,t,n){e instanceof ic?function(e,t,n){const i=e.value.clone(),s=oc(e.fieldTransforms,t,n.transformResults);i.setAll(s),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):e instanceof sc?function(e,t,n){if(!Ja(e.precondition,t))return void t.convertToUnknownDocument(n.version);const i=oc(e.fieldTransforms,t,n.transformResults),s=t.data;s.setAll(rc(e)),s.setAll(i),t.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function tc(e,t,n,i){return e instanceof ic?function(e,t,n,i){if(!Ja(e.precondition,t))return n;const s=e.value.clone(),r=ac(e.fieldTransforms,i,t);return s.setAll(r),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null}(e,t,n,i):e instanceof sc?function(e,t,n,i){if(!Ja(e.precondition,t))return n;const s=ac(e.fieldTransforms,i,t),r=t.data;return r.setAll(rc(e)),r.setAll(s),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,i):function(e,t,n){return Ja(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function nc(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&co(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof $a&&t instanceof $a||e instanceof Ka&&t instanceof Ka?co(e.elements,t.elements,Ho):e instanceof Ga&&t instanceof Ga?Ho(e._t,t._t):e instanceof qa&&t instanceof qa}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class ic extends Ya{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class sc extends Ya{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function rc(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}})),t}function oc(e,t,n){const i=new Map;Wr(e.length===n.length);for(let s=0;s<n.length;s++){const r=e[s],o=r.transform,a=t.data.field(r.field);i.set(r.field,Ba(o,a,n[s]))}return i}function ac(e,t,n){const i=new Map;for(const s of e){const e=s.transform,r=n.data.field(s.field);i.set(s.field,ja(e,r,t))}return i}class cc extends Ya{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class uc{constructor(e){this.count=e}}var hc,lc;function dc(e){if(void 0===e)return zr("GRPC error has no .code"),Xr.UNKNOWN;switch(e){case hc.OK:return Xr.OK;case hc.CANCELLED:return Xr.CANCELLED;case hc.UNKNOWN:return Xr.UNKNOWN;case hc.DEADLINE_EXCEEDED:return Xr.DEADLINE_EXCEEDED;case hc.RESOURCE_EXHAUSTED:return Xr.RESOURCE_EXHAUSTED;case hc.INTERNAL:return Xr.INTERNAL;case hc.UNAVAILABLE:return Xr.UNAVAILABLE;case hc.UNAUTHENTICATED:return Xr.UNAUTHENTICATED;case hc.INVALID_ARGUMENT:return Xr.INVALID_ARGUMENT;case hc.NOT_FOUND:return Xr.NOT_FOUND;case hc.ALREADY_EXISTS:return Xr.ALREADY_EXISTS;case hc.PERMISSION_DENIED:return Xr.PERMISSION_DENIED;case hc.FAILED_PRECONDITION:return Xr.FAILED_PRECONDITION;case hc.ABORTED:return Xr.ABORTED;case hc.OUT_OF_RANGE:return Xr.OUT_OF_RANGE;case hc.UNIMPLEMENTED:return Xr.UNIMPLEMENTED;case hc.DATA_LOSS:return Xr.DATA_LOSS;default:return Gr()}}(lc=hc||(hc={}))[lc.OK=0]="OK",lc[lc.CANCELLED=1]="CANCELLED",lc[lc.UNKNOWN=2]="UNKNOWN",lc[lc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",lc[lc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",lc[lc.NOT_FOUND=5]="NOT_FOUND",lc[lc.ALREADY_EXISTS=6]="ALREADY_EXISTS",lc[lc.PERMISSION_DENIED=7]="PERMISSION_DENIED",lc[lc.UNAUTHENTICATED=16]="UNAUTHENTICATED",lc[lc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",lc[lc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",lc[lc.ABORTED=10]="ABORTED",lc[lc.OUT_OF_RANGE=11]="OUT_OF_RANGE",lc[lc.UNIMPLEMENTED=12]="UNIMPLEMENTED",lc[lc.INTERNAL=13]="INTERNAL",lc[lc.UNAVAILABLE=14]="UNAVAILABLE",lc[lc.DATA_LOSS=15]="DATA_LOSS";class fc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,i]of n)if(this.equalsFn(t,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],e))return void(i[n]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){So(this.inner,((t,n)=>{for(const[t,i]of n)e(t,i)}))}isEmpty(){return function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(this.inner)}size(){return this.innerSize}}const pc=new Co(mo.comparator);function gc(){return pc}const mc=new Co(mo.comparator);function yc(...e){let t=mc;for(const n of e)t=t.insert(n.key,n);return t}function vc(e){let t=mc;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function wc(){return bc()}function Ic(){return bc()}function bc(){return new fc((e=>e.toString()),((e,t)=>e.isEqual(t)))}new Co(mo.comparator);const Ec=new No(mo.comparator);function _c(...e){let t=Ec;for(const n of e)t=t.add(n);return t}const Tc=new No(ao);function Sc(){return Tc}class Cc{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t){const n=new Map;return n.set(e,kc.createSynthesizedTargetChangeForCurrentChange(e,t)),new Cc(ho.min(),n,Sc(),gc(),_c())}}class kc{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t){return new kc(Oo.EMPTY_BYTE_STRING,t,_c(),_c(),_c())}}class Ac{constructor(e,t,n,i){this.gt=e,this.removedTargetIds=t,this.key=n,this.yt=i}}class Nc{constructor(e,t){this.targetId=e,this.It=t}}class Rc{constructor(e,t,n=Oo.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class Dc{constructor(){this.Tt=0,this.Et=Lc(),this.At=Oo.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return 0!==this.Tt}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=_c(),t=_c(),n=_c();return this.Et.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:Gr()}})),new kc(this.At,this.Rt,e,t,n)}Dt(){this.bt=!1,this.Et=Lc()}Ct(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class Oc{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=gc(),this.Bt=Pc(),this.Lt=new No(ao)}Ut(e){for(const t of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(t,e.yt):this.Kt(t,e.key,e.yt);for(const t of e.removedTargetIds)this.Kt(t,e.key,e.yt)}Gt(e){this.forEachTarget(e,(t=>{const n=this.Qt(t);switch(e.state){case 0:this.jt(t)&&n.Vt(e.resumeToken);break;case 1:n.kt(),n.Pt||n.Dt(),n.Vt(e.resumeToken);break;case 2:n.kt(),n.Pt||this.removeTarget(t);break;case 3:this.jt(t)&&(n.Ot(),n.Vt(e.resumeToken));break;case 4:this.jt(t)&&(this.Wt(t),n.Vt(e.resumeToken));break;default:Gr()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach(((e,n)=>{this.jt(n)&&t(n)}))}zt(e){const t=e.targetId,n=e.It.count,i=this.Ht(t);if(i){const e=i.target;if(la(e))if(0===n){const n=new mo(e.path);this.Kt(t,n,oa.newNoDocument(n,ho.min()))}else Wr(1===n);else this.Jt(t)!==n&&(this.Wt(t),this.Lt=this.Lt.add(t))}}Yt(e){const t=new Map;this.Ft.forEach(((n,i)=>{const s=this.Ht(i);if(s){if(n.current&&la(s.target)){const t=new mo(s.target.path);null!==this.$t.get(t)||this.Xt(i,t)||this.Kt(i,t,oa.newNoDocument(t,e))}n.vt&&(t.set(i,n.St()),n.Dt())}}));let n=_c();this.Bt.forEach(((e,t)=>{let i=!0;t.forEachWhile((e=>{const t=this.Ht(e);return!t||2===t.purpose||(i=!1,!1)})),i&&(n=n.add(e))})),this.$t.forEach(((t,n)=>n.setReadTime(e)));const i=new Cc(e,t,this.Lt,this.$t,n);return this.$t=gc(),this.Bt=Pc(),this.Lt=new No(ao),i}qt(e,t){if(!this.jt(e))return;const n=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,n),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}Kt(e,t,n){if(!this.jt(e))return;const i=this.Qt(e);this.Xt(e,t)?i.Ct(t,1):i.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),n&&(this.$t=this.$t.insert(t,n))}removeTarget(e){this.Ft.delete(e)}Jt(e){const t=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let t=this.Ft.get(e);return t||(t=new Dc,this.Ft.set(e,t)),t}Zt(e){let t=this.Bt.get(e);return t||(t=new No(ao),this.Bt=this.Bt.insert(e,t)),t}jt(e){const t=null!==this.Ht(e);return t||$r("WatchChangeAggregator","Detected inactive target",e),t}Ht(e){const t=this.Ft.get(e);return t&&t.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new Dc),this.Mt.getRemoteKeysForTarget(e).forEach((t=>{this.Kt(e,t,null)}))}Xt(e,t){return this.Mt.getRemoteKeysForTarget(e).has(t)}}function Pc(){return new Co(mo.comparator)}function Lc(){return new Co(mo.comparator)}const Mc={asc:"ASCENDING",desc:"DESCENDING"},xc={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class Fc{constructor(e,t){this.databaseId=e,this.dt=t}}function Uc(e){return Wr(!!e),ho.fromTimestamp(function(e){const t=Lo(e);return new uo(t.seconds,t.nanos)}(e))}function Vc(e){const t=fo.fromString(e);return Wr(eu(t)),t}function jc(e,t){const n=Vc(t);if(n.get(1)!==e.databaseId.projectId)throw new Jr(Xr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Jr(Xr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new mo($c(n))}function Bc(e,t){return function(e,t){return function(e){return new fo(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}(e.databaseId,t)}function qc(e){return new fo(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function $c(e){return Wr(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function zc(e,t){return{documents:[Bc(e,t.path)]}}function Kc(e,t){const n={structuredQuery:{}},i=t.path;null!==t.collectionGroup?(n.parent=Bc(e,i),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Bc(e,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const s=function(e){if(0===e.length)return;const t=e.map((e=>function(e){if("=="===e.op){if(ta(e.value))return{unaryFilter:{field:Xc(e.field),op:"IS_NAN"}};if(ea(e.value))return{unaryFilter:{field:Xc(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(ta(e.value))return{unaryFilter:{field:Xc(e.field),op:"IS_NOT_NAN"}};if(ea(e.value))return{unaryFilter:{field:Xc(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xc(e.field),op:Qc(e.op),value:e.value}}}(e)));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(t.filters);s&&(n.structuredQuery.where=s);const r=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Xc(e.field),direction:Wc(e.dir)}}(e)))}(t.orderBy);r&&(n.structuredQuery.orderBy=r);const o=function(e,t){return e.dt||qo(t)?t:{value:t}}(e,t.limit);var a;return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(a=t.startAt).inclusive,values:a.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function Hc(e){let t=function(e){const t=Vc(e);return 4===t.length?fo.emptyPath():$c(t)}(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let s=null;if(i>0){Wr(1===i);const e=n.from[0];e.allDescendants?s=e.collectionId:t=t.child(e.collectionId)}let r=[];n.where&&(r=Gc(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((e=>function(e){return new Ea(Jc(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,qo(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new ba(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new ba(n,t)}(n.endAt)),function(e,t,n,i,s,r,o,a){return new Ca(e,t,n,i,s,r,o,a)}(t,s,o,r,a,"F",c,u)}function Gc(e){return e?void 0!==e.unaryFilter?[Zc(e)]:void 0!==e.fieldFilter?[Yc(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((e=>Gc(e))).reduce(((e,t)=>e.concat(t))):Gr():[]}function Wc(e){return Mc[e]}function Qc(e){return xc[e]}function Xc(e){return{fieldPath:e.canonicalString()}}function Jc(e){return go.fromServerFormat(e.fieldPath)}function Yc(e){return da.create(Jc(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Gr()}}(e.fieldFilter.op),e.fieldFilter.value)}function Zc(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Jc(e.unaryFilter.field);return da.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Jc(e.unaryFilter.field);return da.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Jc(e.unaryFilter.field);return da.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Jc(e.unaryFilter.field);return da.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Gr()}}function eu(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class tu{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const i=this.mutations[t];i.key.isEqual(e.key)&&ec(i,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=tc(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=tc(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Ic();return this.mutations.forEach((i=>{const s=e.get(i.key),r=s.overlayedDocument;let o=this.applyToLocalView(r,s.mutatedFields);o=t.has(i.key)?null:o;const a=Za(r,o);null!==a&&n.set(i.key,a),r.isValidDocument()||r.convertToNoDocument(ho.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),_c())}isEqual(e){return this.batchId===e.batchId&&co(this.mutations,e.mutations,((e,t)=>nc(e,t)))&&co(this.baseMutations,e.baseMutations,((e,t)=>nc(e,t)))}}class nu{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class iu{constructor(e,t,n,i,s=ho.min(),r=ho.min(),o=Oo.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=r,this.resumeToken=o}withSequenceNumber(e){return new iu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new iu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new iu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class su{constructor(e){this.ne=e}}function ru(e){const t=Hc({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Oa(t,t.limit,"L"):t}class ou{constructor(){}re(e,t){this.oe(e,t),t.ue()}oe(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(Mo(e.integerValue));else if("doubleValue"in e){const n=Mo(e.doubleValue);isNaN(n)?this.ce(t,13):(this.ce(t,15),$o(n)?t.ae(0):t.ae(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ce(t,20),"string"==typeof n?t.he(n):(t.he(`${n.seconds||""}`),t.ae(n.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(xo(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ce(t,45),t.ae(n.latitude||0),t.ae(n.longitude||0)}else"mapValue"in e?sa(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):Gr()}le(e,t){this.ce(t,25),this.ge(e,t)}ge(e,t){t.he(e)}we(e,t){const n=e.fields||{};this.ce(t,55);for(const e of Object.keys(n))this.le(e,t),this.oe(n[e],t)}me(e,t){const n=e.values||[];this.ce(t,50);for(const e of n)this.oe(e,t)}_e(e,t){this.ce(t,37),mo.fromName(e).path.forEach((e=>{this.ce(t,60),this.ge(e,t)}))}ce(e,t){e.ae(t)}fe(e){e.ae(2)}}ou.ye=new ou;class au{constructor(){this.ze=new cu}addToCollectionParentIndex(e,t){return this.ze.add(t),bo.resolve()}getCollectionParents(e,t){return bo.resolve(this.ze.getEntries(t))}addFieldIndex(e,t){return bo.resolve()}deleteFieldIndex(e,t){return bo.resolve()}getDocumentsMatchingTarget(e,t){return bo.resolve(null)}getIndexType(e,t){return bo.resolve(0)}getFieldIndexes(e,t){return bo.resolve([])}getNextCollectionGroupToUpdate(e){return bo.resolve(null)}getMinOffset(e,t){return bo.resolve(vo.min())}getMinOffsetFromCollectionGroup(e,t){return bo.resolve(vo.min())}updateCollectionGroup(e,t,n){return bo.resolve()}updateIndexEntries(e,t){return bo.resolve()}}class cu{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new No(fo.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new No(fo.comparator)).toArray()}}new Uint8Array(0);class uu{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new uu(e,uu.DEFAULT_COLLECTION_PERCENTILE,uu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}uu.DEFAULT_COLLECTION_PERCENTILE=10,uu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,uu.DEFAULT=new uu(41943040,uu.DEFAULT_COLLECTION_PERCENTILE,uu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),uu.DISABLED=new uu(-1,0,0);class hu{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new hu(0)}static Rn(){return new hu(-1)}}class lu{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class du{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(n=i,this.getBaseDocument(e,t,n)))).next((e=>(null!==n&&tc(n.mutation,e,Do.empty(),uo.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,_c()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=_c()){const i=wc();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,n).next((e=>{let t=yc();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=wc();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,_c())))}populateOverlays(e,t,n){const i=[];return n.forEach((e=>{t.has(e)||i.push(e)})),this.documentOverlayCache.getOverlays(e,i).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,i){let s=gc();const r=bc(),o=bc();return t.forEach(((e,t)=>{const o=n.get(t.key);i.has(t.key)&&(void 0===o||o.mutation instanceof sc)?s=s.insert(t.key,t):void 0!==o&&(r.set(t.key,o.mutation.getFieldMask()),tc(o.mutation,t,o.mutation.getFieldMask(),uo.now()))})),this.recalculateAndSaveOverlays(e,s).next((e=>(e.forEach(((e,t)=>r.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new lu(t,null!==(n=r.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=bc();let i=new Co(((e,t)=>e-t)),s=_c();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const s of e)s.keys().forEach((e=>{const r=t.get(e);if(null===r)return;let o=n.get(e)||Do.empty();o=s.applyToLocalView(r,o),n.set(e,o);const a=(i.get(s.batchId)||_c()).add(e);i=i.insert(s.batchId,a)}))})).next((()=>{const r=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,c=i.value,u=Ic();c.forEach((e=>{if(!s.has(e)){const i=Za(t.get(e),n.get(e));null!==i&&u.set(e,i),s=s.add(e)}})),r.push(this.documentOverlayCache.saveOverlays(e,a,u))}return bo.waitFor(r)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n){return function(e){return mo.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):function(e){return null!==e.collectionGroup}(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next((s=>{const r=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):bo.resolve(wc());let o=-1,a=s;return r.next((t=>bo.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),s.get(t)?bo.resolve():this.getBaseDocument(e,t,n).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,s))).next((()=>this.computeViews(e,a,t,_c()))).next((e=>({batchId:o,changes:vc(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new mo(t)).next((e=>{let t=yc();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n){const i=t.collectionGroup;let s=yc();return this.indexManager.getCollectionParents(e,i).next((r=>bo.forEach(r,(r=>{const o=function(e,t){return new Ca(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,r.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,n).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n){let i;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next((s=>(i=s,this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)))).next((e=>{e.forEach(((e,t)=>{const n=t.getKey();null===i.get(n)&&(i=i.insert(n,oa.newInvalidDocument(n)))}));let n=yc();return i.forEach(((i,s)=>{const r=e.get(i);void 0!==r&&tc(r.mutation,s,Do.empty(),uo.now()),xa(t,s)&&(n=n.insert(i,s))})),n}))}getBaseDocument(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):bo.resolve(oa.newInvalidDocument(t))}}class fu{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,t){return bo.resolve(this.Jn.get(t))}saveBundleMetadata(e,t){var n;return this.Jn.set(t.id,{id:(n=t).id,version:n.version,createTime:Uc(n.createTime)}),bo.resolve()}getNamedQuery(e,t){return bo.resolve(this.Yn.get(t))}saveNamedQuery(e,t){return this.Yn.set(t.name,function(e){return{name:e.name,query:ru(e.bundledQuery),readTime:Uc(e.readTime)}}(t)),bo.resolve()}}class pu{constructor(){this.overlays=new Co(mo.comparator),this.Xn=new Map}getOverlay(e,t){return bo.resolve(this.overlays.get(t))}getOverlays(e,t){const n=wc();return bo.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,i)=>{this.ie(e,t,i)})),bo.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Xn.get(n);return void 0!==i&&(i.forEach((e=>this.overlays=this.overlays.remove(e))),this.Xn.delete(n)),bo.resolve()}getOverlaysForCollection(e,t,n){const i=wc(),s=t.length+1,r=new mo(t.child("")),o=this.overlays.getIteratorFrom(r);for(;o.hasNext();){const e=o.getNext().value,r=e.getKey();if(!t.isPrefixOf(r.path))break;r.path.length===s&&e.largestBatchId>n&&i.set(e.getKey(),e)}return bo.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new Co(((e,t)=>e-t));const r=this.overlays.getIterator();for(;r.hasNext();){const e=r.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=s.get(e.largestBatchId);null===t&&(t=wc(),s=s.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=wc(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=i)););return bo.resolve(o)}ie(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const e=this.Xn.get(i.largestBatchId).delete(n.key);this.Xn.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new nu(t,n));let s=this.Xn.get(t);void 0===s&&(s=_c(),this.Xn.set(t,s)),this.Xn.set(t,s.add(n.key))}}class gu{constructor(){this.Zn=new No(mu.ts),this.es=new No(mu.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,t){const n=new mu(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}ss(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.rs(new mu(e,t))}os(e,t){e.forEach((e=>this.removeReference(e,t)))}us(e){const t=new mo(new fo([])),n=new mu(t,e),i=new mu(t,e+1),s=[];return this.es.forEachInRange([n,i],(e=>{this.rs(e),s.push(e.key)})),s}cs(){this.Zn.forEach((e=>this.rs(e)))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const t=new mo(new fo([])),n=new mu(t,e),i=new mu(t,e+1);let s=_c();return this.es.forEachInRange([n,i],(e=>{s=s.add(e.key)})),s}containsKey(e){const t=new mu(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class mu{constructor(e,t){this.key=e,this.ls=t}static ts(e,t){return mo.comparator(e.key,t.key)||ao(e.ls,t.ls)}static ns(e,t){return ao(e.ls,t.ls)||mo.comparator(e.key,t.key)}}class yu{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.fs=1,this.ds=new No(mu.ts)}checkEmpty(e){return bo.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const s=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const r=new tu(s,t,n,i);this.mutationQueue.push(r);for(const t of i)this.ds=this.ds.add(new mu(t.key,s)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return bo.resolve(r)}lookupMutationBatch(e,t){return bo.resolve(this._s(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.ws(n),s=i<0?0:i;return bo.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return bo.resolve(0===this.mutationQueue.length?-1:this.fs-1)}getAllMutationBatches(e){return bo.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new mu(t,0),i=new mu(t,Number.POSITIVE_INFINITY),s=[];return this.ds.forEachInRange([n,i],(e=>{const t=this._s(e.ls);s.push(t)})),bo.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new No(ao);return t.forEach((e=>{const t=new mu(e,0),i=new mu(e,Number.POSITIVE_INFINITY);this.ds.forEachInRange([t,i],(e=>{n=n.add(e.ls)}))})),bo.resolve(this.gs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;mo.isDocumentKey(s)||(s=s.child(""));const r=new mu(new mo(s),0);let o=new No(ao);return this.ds.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===i&&(o=o.add(e.ls)),!0)}),r),bo.resolve(this.gs(o))}gs(e){const t=[];return e.forEach((e=>{const n=this._s(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Wr(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();let n=this.ds;return bo.forEach(t.mutations,(i=>{const s=new mu(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.ds=n}))}In(e){}containsKey(e,t){const n=new mu(t,0),i=this.ds.firstAfterOrEqual(n);return bo.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,bo.resolve()}ys(e,t){return this.ws(e)}ws(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}_s(e){const t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class vu{constructor(e){this.ps=e,this.docs=new Co(mo.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,r=this.ps(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:r}),this.size+=r-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return bo.resolve(n?n.document.mutableCopy():oa.newInvalidDocument(t))}getEntries(e,t){let n=gc();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():oa.newInvalidDocument(e))})),bo.resolve(n)}getAllFromCollection(e,t,n){let i=gc();const s=new mo(t.child("")),r=this.docs.getIteratorFrom(s);for(;r.hasNext();){const{key:e,value:{document:s}}=r.getNext();if(!t.isPrefixOf(e.path))break;e.path.length>t.length+1||wo(yo(s),n)<=0||(i=i.insert(s.key,s.mutableCopy()))}return bo.resolve(i)}getAllFromCollectionGroup(e,t,n,i){Gr()}Is(e,t){return bo.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new wu(this)}getSize(e){return bo.resolve(this.size)}}class wu extends class{constructor(){this.changes=new fc((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,oa.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?bo.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}{constructor(e){super(),this.zn=e}applyChanges(e){const t=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?t.push(this.zn.addEntry(e,i)):this.zn.removeEntry(n)})),bo.waitFor(t)}getFromCache(e,t){return this.zn.getEntry(e,t)}getAllFromCache(e,t){return this.zn.getEntries(e,t)}}class Iu{constructor(e){this.persistence=e,this.Ts=new fc((e=>ua(e)),ha),this.lastRemoteSnapshotVersion=ho.min(),this.highestTargetId=0,this.Es=0,this.As=new gu,this.targetCount=0,this.Rs=hu.An()}forEachTarget(e,t){return this.Ts.forEach(((e,n)=>t(n))),bo.resolve()}getLastRemoteSnapshotVersion(e){return bo.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return bo.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),bo.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Es&&(this.Es=t),bo.resolve()}vn(e){this.Ts.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Rs=new hu(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,t){return this.vn(t),this.targetCount+=1,bo.resolve()}updateTargetData(e,t){return this.vn(t),bo.resolve()}removeTargetData(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,bo.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.Ts.forEach(((r,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Ts.delete(r),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),bo.waitFor(s).next((()=>i))}getTargetCount(e){return bo.resolve(this.targetCount)}getTargetData(e,t){const n=this.Ts.get(t)||null;return bo.resolve(n)}addMatchingKeys(e,t,n){return this.As.ss(t,n),bo.resolve()}removeMatchingKeys(e,t,n){this.As.os(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((t=>{s.push(i.markPotentiallyOrphaned(e,t))})),bo.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.As.us(t),bo.resolve()}getMatchingKeysForTargetId(e,t){const n=this.As.hs(t);return bo.resolve(n)}containsKey(e,t){return bo.resolve(this.As.containsKey(t))}}class bu{constructor(e,t){this.bs={},this.overlays={},this.Ps=new _o(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new Iu(this),this.indexManager=new au,this.remoteDocumentCache=function(e){return new vu(e)}((e=>this.referenceDelegate.Ss(e))),this.wt=new su(t),this.Ds=new fu(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new pu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.bs[e.toKey()];return n||(n=new yu(t,this.referenceDelegate),this.bs[e.toKey()]=n),n}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,t,n){$r("MemoryPersistence","Starting transaction:",e);const i=new Eu(this.Ps.next());return this.referenceDelegate.Cs(),n(i).next((e=>this.referenceDelegate.xs(i).next((()=>e)))).toPromise().then((e=>(i.raiseOnCommittedEvent(),e)))}Ns(e,t){return bo.or(Object.values(this.bs).map((n=>()=>n.containsKey(e,t))))}}class Eu extends class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}{constructor(e){super(),this.currentSequenceNumber=e}}class _u{constructor(e){this.persistence=e,this.ks=new gu,this.Os=null}static Ms(e){return new _u(e)}get Fs(){if(this.Os)return this.Os;throw Gr()}addReference(e,t,n){return this.ks.addReference(n,t),this.Fs.delete(n.toString()),bo.resolve()}removeReference(e,t,n){return this.ks.removeReference(n,t),this.Fs.add(n.toString()),bo.resolve()}markPotentiallyOrphaned(e,t){return this.Fs.add(t.toString()),bo.resolve()}removeTarget(e,t){this.ks.us(t.targetId).forEach((e=>this.Fs.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Fs.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Cs(){this.Os=new Set}xs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return bo.forEach(this.Fs,(n=>{const i=mo.fromPath(n);return this.$s(e,i).next((e=>{e||t.removeEntry(i,ho.min())}))})).next((()=>(this.Os=null,t.apply(e))))}updateLimboDocument(e,t){return this.$s(e,t).next((e=>{e?this.Fs.delete(t.toString()):this.Fs.add(t.toString())}))}Ss(e){return 0}$s(e,t){return bo.or([()=>bo.resolve(this.ks.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ns(e,t)])}}class Tu{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Pi=n,this.vi=i}static Vi(e,t){let n=_c(),i=_c();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:i=i.add(e.doc.key)}return new Tu(e,t.fromCache,n,i)}}class Su{constructor(){this.Si=!1}initialize(e,t){this.Di=e,this.indexManager=t,this.Si=!0}getDocumentsMatchingQuery(e,t,n,i){return this.Ci(e,t).next((s=>s||this.xi(e,t,i,n))).next((n=>n||this.Ni(e,t)))}Ci(e,t){return bo.resolve(null)}xi(e,t,n,i){return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||i.isEqual(ho.min())?this.Ni(e,t):this.Di.getDocuments(e,n).next((s=>{const r=this.ki(t,s);return this.Oi(t,r,n,i)?this.Ni(e,t):(qr()<=N.DEBUG&&$r("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ma(t)),this.Mi(e,r,t,function(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,s=ho.fromTimestamp(1e9===i?new uo(n+1,0):new uo(n,i));return new vo(s,mo.empty(),t)}(i,-1)))}))}ki(e,t){let n=new No(Fa(e));return t.forEach(((t,i)=>{xa(e,i)&&(n=n.add(i))})),n}Oi(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ni(e,t){return qr()<=N.DEBUG&&$r("QueryEngine","Using full collection scan to execute query:",Ma(t)),this.Di.getDocumentsMatchingQuery(e,t,vo.min())}Mi(e,t,n,i){return this.Di.getDocumentsMatchingQuery(e,n,i).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class Cu{constructor(e,t,n,i){this.persistence=e,this.Fi=t,this.wt=i,this.$i=new Co(ao),this.Bi=new fc((e=>ua(e)),ha),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(n)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new du(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.$i)))}}async function ku(e,t){const n=Qr(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let i;return n.mutationQueue.getAllMutationBatches(e).next((s=>(i=s,n.qi(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const s=[],r=[];let o=_c();for(const e of i){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({Ki:e,removedBatchIds:s,addedBatchIds:r})))}))}))}function Au(e){const t=Qr(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Vs.getLastRemoteSnapshotVersion(e)))}async function Nu(e,t,n){const i=Qr(e),s=i.$i.get(t),r=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",r,(e=>i.persistence.referenceDelegate.removeTarget(e,s)))}catch(e){if(!Eo(e))throw e;$r("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}i.$i=i.$i.remove(t),i.Bi.delete(s.target)}function Ru(e,t,n){const i=Qr(e);let s=ho.min(),r=_c();return i.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const i=Qr(e),s=i.Bi.get(n);return void 0!==s?bo.resolve(i.$i.get(s)):i.Vs.getTargetData(t,n)}(i,e,Da(t)).next((t=>{if(t)return s=t.lastLimboFreeSnapshotVersion,i.Vs.getMatchingKeysForTargetId(e,t.targetId).next((e=>{r=e}))})).next((()=>i.Fi.getDocumentsMatchingQuery(e,t,n?s:ho.min(),n?r:_c()))).next((e=>(function(e,t,n){let i=ho.min();n.forEach(((e,t)=>{t.readTime.compareTo(i)>0&&(i=t.readTime)})),e.Li.set(t,i)}(i,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,ji:r})))))}class Du{constructor(){this.activeTargetIds=Sc()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ou{constructor(){this.Fr=new Du,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,t,n){this.$r[e]=t}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new Du,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Pu{Br(e){}shutdown(){}}class Lu{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){$r("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){$r("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Mu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class xu{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}class Fu extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.so=t+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,t,n,i,s){const r=this.oo(e,t);$r("RestConnection","Sending: ",r,n);const o={};return this.uo(o,i,s),this.co(e,r,o,n).then((e=>($r("RestConnection","Received: ",e),e)),(t=>{throw Kr("RestConnection",`${e} failed with error: `,t,"url: ",r,"request:",n),t}))}ao(e,t,n,i,s,r){return this.ro(e,t,n,i,s)}uo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+jr,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}oo(e,t){const n=Mu[e];return`${this.so}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,t,n,i){return new Promise(((s,r)=>{const o=new Fr;o.listenOnce(Or.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case Dr.NO_ERROR:const t=o.getResponseJson();$r("Connection","XHR received:",JSON.stringify(t)),s(t);break;case Dr.TIMEOUT:$r("Connection",'RPC "'+e+'" timed out'),r(new Jr(Xr.DEADLINE_EXCEEDED,"Request time out"));break;case Dr.HTTP_ERROR:const n=o.getStatus();if($r("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const e=o.getResponseJson().error;if(e&&e.status&&e.message){const t=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Xr).indexOf(t)>=0?t:Xr.UNKNOWN}(e.status);r(new Jr(t,e.message))}else r(new Jr(Xr.UNKNOWN,"Server responded with status "+o.getStatus()))}else r(new Jr(Xr.UNAVAILABLE,"Connection failed."));break;default:Gr()}}finally{$r("Connection",'RPC "'+e+'" completed.')}}));const a=JSON.stringify(i);o.send(t,"POST",a,n,15)}))}ho(e,t,n){const i=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Nr(),h=Rr(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(l.xmlHttpFactory=new Mr({})),this.uo(l.initMessageHeaders,t,n),o()||c()||r().indexOf("Electron/")>=0||u()||r().indexOf("MSAppHost/")>=0||a()||(l.httpHeadersOverwriteParam="$httpHeaders");const d=i.join("");$r("Connection","Creating WebChannel: "+d,l);const f=s.createWebChannel(d,l);let p=!1,g=!1;const m=new xu({jr:e=>{g?$r("Connection","Not sending because WebChannel is closed:",e):(p||($r("Connection","Opening WebChannel transport."),f.open(),p=!0),$r("Connection","WebChannel sending:",e),f.send(e))},Wr:()=>f.close()}),y=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return y(f,xr.EventType.OPEN,(()=>{g||$r("Connection","WebChannel transport opened.")})),y(f,xr.EventType.CLOSE,(()=>{g||(g=!0,$r("Connection","WebChannel transport closed"),m.eo())})),y(f,xr.EventType.ERROR,(e=>{g||(g=!0,Kr("Connection","WebChannel transport errored:",e),m.eo(new Jr(Xr.UNAVAILABLE,"The operation could not be completed")))})),y(f,xr.EventType.MESSAGE,(e=>{var t;if(!g){const n=e.data[0];Wr(!!n);const i=n,s=i.error||(null===(t=i[0])||void 0===t?void 0:t.error);if(s){$r("Connection","WebChannel received error:",s);const e=s.status;let t=function(e){const t=hc[e];if(void 0!==t)return dc(t)}(e),n=s.message;void 0===t&&(t=Xr.INTERNAL,n="Unknown error status: "+e+" with message "+s.message),g=!0,m.eo(new Jr(t,n)),f.close()}else $r("Connection","WebChannel received:",n),m.no(n)}})),y(h,Pr.STAT_EVENT,(e=>{e.stat===Lr.PROXY?$r("Connection","Detected buffering proxy"):e.stat===Lr.NOPROXY&&$r("Connection","Detected no buffering proxy")})),setTimeout((()=>{m.Zr()}),0),m}}function Uu(){return"undefined"!=typeof document?document:null}function Vu(e){return new Fc(e,!0)}class ju{constructor(e,t,n=1e3,i=1.5,s=6e4){this.js=e,this.timerId=t,this.lo=n,this.fo=i,this._o=s,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const t=Math.floor(this.wo+this.To()),n=Math.max(0,Date.now()-this.yo),i=Math.max(0,t-n);i>0&&$r("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.wo} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,i,(()=>(this.yo=Date.now(),e()))),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}cancel(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}class Bu extends class{constructor(e,t,n,i,s,r,o,a){this.js=e,this.Ao=n,this.Ro=i,this.bo=s,this.authCredentialsProvider=r,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new ju(e,t)}Do(){return 1===this.state||5===this.state||this.Co()}Co(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.xo()}async stop(){this.Do()&&await this.close(0)}No(){this.state=0,this.So.reset()}ko(){this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,(()=>this.Oo())))}Mo(e){this.Fo(),this.stream.send(e)}async Oo(){if(this.Co())return this.close(0)}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}async close(e,t){this.Fo(),this.$o(),this.So.cancel(),this.Po++,4!==e?this.So.reset():t&&t.code===Xr.RESOURCE_EXHAUSTED?(zr(t.toString()),zr("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):t&&t.code===Xr.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Bo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Jr(t)}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),t=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.Po===t&&this.Uo(e,n)}),(t=>{e((()=>{const e=new Jr(Xr.UNKNOWN,"Fetching auth token failed: "+t.message);return this.qo(e)}))}))}Uo(e,t){const n=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr((()=>{n((()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,(()=>(this.Co()&&(this.state=3),Promise.resolve()))),this.listener.zr())))})),this.stream.Jr((e=>{n((()=>this.qo(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}xo(){this.state=5,this.So.Io((async()=>{this.state=0,this.start()}))}qo(e){return $r("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return t=>{this.js.enqueueAndForget((()=>this.Po===e?t():($r("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}{constructor(e,t,n,i,s,r){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,r),this.wt=s}Ko(e,t){return this.bo.ho("Listen",e,t)}onMessage(e){this.So.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Gr()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],r=function(e,t){return e.dt?(Wr(void 0===t||"string"==typeof t),Oo.fromBase64String(t||"")):(Wr(void 0===t||t instanceof Uint8Array),Oo.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Xr.UNKNOWN:dc(e.code);return new Jr(t,e.message||"")}(o);n=new Rc(i,s,r,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const s=jc(e,i.document.name),r=Uc(i.document.updateTime),o=new ra({mapValue:{fields:i.document.fields}}),a=oa.newFoundDocument(s,r,o),c=i.targetIds||[],u=i.removedTargetIds||[];n=new Ac(c,u,a.key,a)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const s=jc(e,i.document),r=i.readTime?Uc(i.readTime):ho.min(),o=oa.newNoDocument(s,r),a=i.removedTargetIds||[];n=new Ac([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const s=jc(e,i.document),r=i.removedTargetIds||[];n=new Ac([],r,s,null)}else{if(!("filter"in t))return Gr();{t.filter;const e=t.filter;e.targetId;const i=e.count||0,s=new uc(i),r=e.targetId;n=new Nc(r,s)}}return n}(this.wt,e),n=function(e){if(!("targetChange"in e))return ho.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?ho.min():t.readTime?Uc(t.readTime):ho.min()}(e);return this.listener.Go(t,n)}Qo(e){const t={};t.database=qc(this.wt),t.addTarget=function(e,t){let n;const i=t.target;return n=la(i)?{documents:zc(e,i)}:{query:Kc(e,i)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=function(e,t){return e.dt?t.toBase64():t.toUint8Array()}(e,t.resumeToken):t.snapshotVersion.compareTo(ho.min())>0&&(n.readTime=function(e,t){return e.dt?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}(e,t.snapshotVersion.toTimestamp())),n}(this.wt,e);const n=function(e,t){const n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Gr()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.wt,e);n&&(t.labels=n),this.Mo(t)}jo(e){const t={};t.database=qc(this.wt),t.removeTarget=e,this.Mo(t)}}class qu extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.bo=n,this.wt=i,this.Zo=!1}tu(){if(this.Zo)throw new Jr(Xr.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,t,n){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.bo.ro(e,t,n,i,s))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Xr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Jr(Xr.UNKNOWN,e.toString())}))}ao(e,t,n,i){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,r])=>this.bo.ao(e,t,n,s,r,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Xr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Jr(Xr.UNKNOWN,e.toString())}))}terminate(){this.Zo=!0}}class $u{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve()))))}uu(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(zr(t),this.su=!1):$r("OnlineStateTracker",t)}cu(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}class zu{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=s,this.du.Br((e=>{n.enqueueAndForget((async()=>{Zu(this)&&($r("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Qr(e);t.lu.add(4),await Hu(t),t._u.set("Unknown"),t.lu.delete(4),await Ku(t)}(this))}))})),this._u=new $u(n,i)}}async function Ku(e){if(Zu(e))for(const t of e.fu)await t(!0)}async function Hu(e){for(const t of e.fu)await t(!1)}function Gu(e,t){const n=Qr(e);n.hu.has(t.targetId)||(n.hu.set(t.targetId,t),Yu(n)?Ju(n):oh(n).Co()&&Qu(n,t))}function Wu(e,t){const n=Qr(e),i=oh(n);n.hu.delete(t),i.Co()&&Xu(n,t),0===n.hu.size&&(i.Co()?i.ko():Zu(n)&&n._u.set("Unknown"))}function Qu(e,t){e.wu.Nt(t.targetId),oh(e).Qo(t)}function Xu(e,t){e.wu.Nt(t),oh(e).jo(t)}function Ju(e){e.wu=new Oc({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),te:t=>e.hu.get(t)||null}),oh(e).start(),e._u.iu()}function Yu(e){return Zu(e)&&!oh(e).Do()&&e.hu.size>0}function Zu(e){return 0===Qr(e).lu.size}function eh(e){e.wu=void 0}async function th(e){e.hu.forEach(((t,n)=>{Qu(e,t)}))}async function nh(e,t){eh(e),Yu(e)?(e._u.uu(t),Ju(e)):e._u.set("Unknown")}async function ih(e,t,n){if(e._u.set("Online"),t instanceof Rc&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const i of t.targetIds)e.hu.has(i)&&(await e.remoteSyncer.rejectListen(i,n),e.hu.delete(i),e.wu.removeTarget(i))}(e,t)}catch(n){$r("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await sh(e,n)}else if(t instanceof Ac?e.wu.Ut(t):t instanceof Nc?e.wu.zt(t):e.wu.Gt(t),!n.isEqual(ho.min()))try{const t=await Au(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.wu.Yt(t);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const s=e.hu.get(i);s&&e.hu.set(i,s.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((t=>{const n=e.hu.get(t);if(!n)return;e.hu.set(t,n.withResumeToken(Oo.EMPTY_BYTE_STRING,n.snapshotVersion)),Xu(e,t);const i=new iu(n.target,t,1,n.sequenceNumber);Qu(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){$r("RemoteStore","Failed to raise snapshot:",t),await sh(e,t)}}async function sh(e,t,n){if(!Eo(t))throw t;e.lu.add(1),await Hu(e),e._u.set("Offline"),n||(n=()=>Au(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{$r("RemoteStore","Retrying IndexedDB access"),await n(),e.lu.delete(1),await Ku(e)}))}async function rh(e,t){const n=Qr(e);n.asyncQueue.verifyOperationInProgress(),$r("RemoteStore","RemoteStore received new credentials");const i=Zu(n);n.lu.add(3),await Hu(n),i&&n._u.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.lu.delete(3),await Ku(n)}function oh(e){return e.mu||(e.mu=function(e,t,n){const i=Qr(e);return i.tu(),new Bu(t,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,n)}(e.datastore,e.asyncQueue,{zr:th.bind(null,e),Jr:nh.bind(null,e),Go:ih.bind(null,e)}),e.fu.push((async t=>{t?(e.mu.No(),Yu(e)?Ju(e):e._u.set("Unknown")):(await e.mu.stop(),eh(e))}))),e.mu}class ah{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Yr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,i,s){const r=Date.now()+n,o=new ah(e,t,r,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Jr(Xr.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ch(e,t){if(zr("AsyncQueue",`${t}: ${e}`),Eo(e))return new Jr(Xr.UNAVAILABLE,`${t}: ${e}`);throw e}class uh{constructor(e){this.comparator=e?(t,n)=>e(t,n)||mo.comparator(t.key,n.key):(e,t)=>mo.comparator(e.key,t.key),this.keyedMap=yc(),this.sortedSet=new Co(this.comparator)}static emptySet(e){return new uh(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof uh))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(!e.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new uh;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class hh{constructor(){this.yu=new Co(mo.comparator)}track(e){const t=e.doc.key,n=this.yu.get(t);n?0!==e.type&&3===n.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==n.type?this.yu=this.yu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.yu=this.yu.remove(t):1===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):Gr():this.yu=this.yu.insert(t,e)}pu(){const e=[];return this.yu.inorderTraversal(((t,n)=>{e.push(n)})),e}}class lh{constructor(e,t,n,i,s,r,o,a){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=r,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(e,t,n,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new lh(e,t,uh.emptySet(t),s,n,i,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Pa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class dh{constructor(){this.Iu=void 0,this.listeners=[]}}class fh{constructor(){this.queries=new fc((e=>La(e)),Pa),this.onlineState="Unknown",this.Tu=new Set}}function ph(e,t){const n=Qr(e);let i=!1;for(const e of t){const t=e.query,s=n.queries.get(t);if(s){for(const t of s.listeners)t.Au(e)&&(i=!0);s.Iu=e}}i&&mh(n)}function gh(e,t,n){const i=Qr(e),s=i.queries.get(t);if(s)for(const e of s.listeners)e.onError(n);i.queries.delete(t)}function mh(e){e.Tu.forEach((e=>{e.next()}))}class yh{constructor(e,t,n){this.query=e,this.Ru=t,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=n||{}}Au(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new lh(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),t=!0):this.Vu(e,this.onlineState)&&(this.Su(e),t=!0),this.Pu=e,t}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}Vu(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return!(this.options.Du&&n||e.docs.isEmpty()&&"Offline"!==t)}vu(e){if(e.docChanges.length>0)return!0;const t=this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Su(e){e=lh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}class vh{constructor(e){this.key=e}}class wh{constructor(e){this.key=e}}class Ih{constructor(e,t){this.query=e,this.Fu=t,this.$u=null,this.current=!1,this.Bu=_c(),this.mutatedKeys=_c(),this.Lu=Fa(e),this.Uu=new uh(this.Lu)}get qu(){return this.Fu}Ku(e,t){const n=t?t.Gu:new hh,i=t?t.Uu:this.Uu;let s=t?t.mutatedKeys:this.mutatedKeys,r=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((e,t)=>{const u=i.get(e),h=xa(this.query,t)?t:null,l=!!u&&this.mutatedKeys.has(u.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let f=!1;u&&h?u.data.isEqual(h.data)?l!==d&&(n.track({type:3,doc:h}),f=!0):this.Qu(u,h)||(n.track({type:2,doc:h}),f=!0,(a&&this.Lu(h,a)>0||c&&this.Lu(h,c)<0)&&(o=!0)):!u&&h?(n.track({type:0,doc:h}),f=!0):u&&!h&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(h?(r=r.add(h),s=d?s.add(e):s.delete(e)):(r=r.delete(e),s=s.delete(e)))})),null!==this.query.limit)for(;r.size>this.query.limit;){const e="F"===this.query.limitType?r.last():r.first();r=r.delete(e.key),s=s.delete(e.key),n.track({type:1,doc:e})}return{Uu:r,Gu:n,Oi:o,mutatedKeys:s}}Qu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const i=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const s=e.Gu.pu();s.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Gr()}};return n(e)-n(t)}(e.type,t.type)||this.Lu(e.doc,t.doc))),this.ju(n);const r=t?this.Wu():[],o=0===this.Bu.size&&this.current?1:0,a=o!==this.$u;return this.$u=o,0!==s.length||a?{snapshot:new lh(this.query,e.Uu,i,s,e.mutatedKeys,0===o,a,!1),zu:r}:{zu:r}}Eu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new hh,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach((e=>this.Fu=this.Fu.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Fu=this.Fu.delete(e))),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=_c(),this.Uu.forEach((e=>{this.Hu(e.key)&&(this.Bu=this.Bu.add(e.key))}));const t=[];return e.forEach((e=>{this.Bu.has(e)||t.push(new wh(e))})),this.Bu.forEach((n=>{e.has(n)||t.push(new vh(n))})),t}Ju(e){this.Fu=e.ji,this.Bu=_c();const t=this.Ku(e.documents);return this.applyChanges(t,!0)}Yu(){return lh.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}class bh{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Eh{constructor(e){this.key=e,this.Xu=!1}}class _h{constructor(e,t,n,i,s,r){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=r,this.Zu={},this.tc=new fc((e=>La(e)),Pa),this.ec=new Map,this.nc=new Set,this.sc=new Co(mo.comparator),this.ic=new Map,this.rc=new gu,this.oc={},this.uc=new Map,this.cc=hu.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return!0===this.ac}}async function Th(e,t){const n=function(e){const t=Qr(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Ch.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=xh.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Ah.bind(null,t),t.Zu.Go=ph.bind(null,t.eventManager),t.Zu.lc=gh.bind(null,t.eventManager),t}(e);let i,s;const r=n.tc.get(t);if(r)i=r.targetId,n.sharedClientState.addLocalQueryTarget(i),s=r.view.Yu();else{const e=await function(e,t){const n=Qr(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let i;return n.Vs.getTargetData(e,t).next((s=>s?(i=s,bo.resolve(i)):n.Vs.allocateTargetId(e).next((s=>(i=new iu(t,s,0,e.currentSequenceNumber),n.Vs.addTargetData(e,i).next((()=>i)))))))})).then((e=>{const i=n.$i.get(e.targetId);return(null===i||e.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.$i=n.$i.insert(e.targetId,e),n.Bi.set(t,e.targetId)),e}))}(n.localStore,Da(t));n.isPrimaryClient&&Gu(n.remoteStore,e);const r=n.sharedClientState.addLocalQueryTarget(e.targetId);i=e.targetId,s=await async function(e,t,n,i){e.hc=(t,n,i)=>async function(e,t,n,i){let s=t.view.Ku(n);s.Oi&&(s=await Ru(e.localStore,t.query,!1).then((({documents:e})=>t.view.Ku(e,s))));const r=i&&i.targetChanges.get(t.targetId),o=t.view.applyChanges(s,e.isPrimaryClient,r);return Dh(e,t.targetId,o.zu),o.snapshot}(e,t,n,i);const s=await Ru(e.localStore,t,!0),r=new Ih(t,s.ji),o=r.Ku(s.documents),a=kc.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==e.onlineState),c=r.applyChanges(o,e.isPrimaryClient,a);Dh(e,n,c.zu);const u=new bh(t,n,r);return e.tc.set(t,u),e.ec.has(n)?e.ec.get(n).push(t):e.ec.set(n,[t]),c.snapshot}(n,t,i,"current"===r)}return s}async function Sh(e,t){const n=Qr(e),i=n.tc.get(t),s=n.ec.get(i.targetId);if(s.length>1)return n.ec.set(i.targetId,s.filter((e=>!Pa(e,t)))),void n.tc.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Nu(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),Wu(n.remoteStore,i.targetId),Nh(n,i.targetId)})).catch(Io)):(Nh(n,i.targetId),await Nu(n.localStore,i.targetId,!0))}async function Ch(e,t){const n=Qr(e);try{const e=await function(e,t){const n=Qr(e),i=t.snapshotVersion;let s=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const r=n.Ui.newChangeBuffer({trackRemovals:!0});s=n.$i;const o=[];t.targetChanges.forEach(((r,a)=>{const c=s.get(a);if(!c)return;o.push(n.Vs.removeMatchingKeys(e,r.removedDocuments,a).next((()=>n.Vs.addMatchingKeys(e,r.addedDocuments,a))));let u=c.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(a)?u=u.withResumeToken(Oo.EMPTY_BYTE_STRING,ho.min()).withLastLimboFreeSnapshotVersion(ho.min()):r.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(r.resumeToken,i)),s=s.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,r)&&o.push(n.Vs.updateTargetData(e,u))}));let a=gc(),c=_c();if(t.documentUpdates.forEach((i=>{t.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,i))})),o.push(function(e,t,n){let i=_c(),s=_c();return n.forEach((e=>i=i.add(e))),t.getEntries(e,i).next((e=>{let i=gc();return n.forEach(((n,r)=>{const o=e.get(n);r.isFoundDocument()!==o.isFoundDocument()&&(s=s.add(n)),r.isNoDocument()&&r.version.isEqual(ho.min())?(t.removeEntry(n,r.readTime),i=i.insert(n,r)):!o.isValidDocument()||r.version.compareTo(o.version)>0||0===r.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(r),i=i.insert(n,r)):$r("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",r.version)})),{Gi:i,Qi:s}}))}(e,r,t.documentUpdates).next((e=>{a=e.Gi,c=e.Qi}))),!i.isEqual(ho.min())){const t=n.Vs.getLastRemoteSnapshotVersion(e).next((t=>n.Vs.setTargetsMetadata(e,e.currentSequenceNumber,i)));o.push(t)}return bo.waitFor(o).next((()=>r.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.$i=s,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const i=n.ic.get(t);i&&(Wr(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?i.Xu=!0:e.modifiedDocuments.size>0?Wr(i.Xu):e.removedDocuments.size>0&&(Wr(i.Xu),i.Xu=!1))})),await Lh(n,e,t)}catch(e){await Io(e)}}function kh(e,t,n){const i=Qr(e);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const e=[];i.tc.forEach(((n,i)=>{const s=i.view.Eu(t);s.snapshot&&e.push(s.snapshot)})),function(e,t){const n=Qr(e);n.onlineState=t;let i=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.Eu(t)&&(i=!0)})),i&&mh(n)}(i.eventManager,t),e.length&&i.Zu.Go(e),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function Ah(e,t,n){const i=Qr(e);i.sharedClientState.updateQueryState(t,"rejected",n);const s=i.ic.get(t),r=s&&s.key;if(r){let e=new Co(mo.comparator);e=e.insert(r,oa.newNoDocument(r,ho.min()));const n=_c().add(r),s=new Cc(ho.min(),new Map,new No(ao),e,n);await Ch(i,s),i.sc=i.sc.remove(r),i.ic.delete(t),Ph(i)}else await Nu(i.localStore,t,!1).then((()=>Nh(i,t,n))).catch(Io)}function Nh(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.ec.get(t))e.tc.delete(i),n&&e.Zu.lc(i,n);e.ec.delete(t),e.isPrimaryClient&&e.rc.us(t).forEach((t=>{e.rc.containsKey(t)||Rh(e,t)}))}function Rh(e,t){e.nc.delete(t.path.canonicalString());const n=e.sc.get(t);null!==n&&(Wu(e.remoteStore,n),e.sc=e.sc.remove(t),e.ic.delete(n),Ph(e))}function Dh(e,t,n){for(const i of n)i instanceof vh?(e.rc.addReference(i.key,t),Oh(e,i)):i instanceof wh?($r("SyncEngine","Document no longer in limbo: "+i.key),e.rc.removeReference(i.key,t),e.rc.containsKey(i.key)||Rh(e,i.key)):Gr()}function Oh(e,t){const n=t.key,i=n.path.canonicalString();e.sc.get(n)||e.nc.has(i)||($r("SyncEngine","New document in limbo: "+n),e.nc.add(i),Ph(e))}function Ph(e){for(;e.nc.size>0&&e.sc.size<e.maxConcurrentLimboResolutions;){const t=e.nc.values().next().value;e.nc.delete(t);const n=new mo(fo.fromString(t)),i=e.cc.next();e.ic.set(i,new Eh(n)),e.sc=e.sc.insert(n,i),Gu(e.remoteStore,new iu(Da(ka(n.path)),i,2,_o.ot))}}async function Lh(e,t,n){const i=Qr(e),s=[],r=[],o=[];i.tc.isEmpty()||(i.tc.forEach(((e,a)=>{o.push(i.hc(a,t,n).then((e=>{if(e){i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,e.fromCache?"not-current":"current"),s.push(e);const t=Tu.Vi(a.targetId,e);r.push(t)}})))})),await Promise.all(o),i.Zu.Go(s),await async function(e,t){const n=Qr(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>bo.forEach(t,(t=>bo.forEach(t.Pi,(i=>n.persistence.referenceDelegate.addReference(e,t.targetId,i))).next((()=>bo.forEach(t.vi,(i=>n.persistence.referenceDelegate.removeReference(e,t.targetId,i)))))))))}catch(e){if(!Eo(e))throw e;$r("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.$i.get(t),i=e.snapshotVersion,s=e.withLastLimboFreeSnapshotVersion(i);n.$i=n.$i.insert(t,s)}}}(i.localStore,r))}async function Mh(e,t){const n=Qr(e);if(!n.currentUser.isEqual(t)){$r("SyncEngine","User change. New user:",t.toKey());const e=await ku(n.localStore,t);n.currentUser=t,function(e,t){e.uc.forEach((e=>{e.forEach((e=>{e.reject(new Jr(Xr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.uc.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Lh(n,e.Ki)}}function xh(e,t){const n=Qr(e),i=n.ic.get(t);if(i&&i.Xu)return _c().add(i.key);{let e=_c();const i=n.ec.get(t);if(!i)return e;for(const t of i){const i=n.tc.get(t);e=e.unionWith(i.view.qu)}return e}}class Fh{constructor(){this.synchronizeTabs=!1}async initialize(e){this.wt=Vu(e.databaseInfo.databaseId),this.sharedClientState=this.dc(e),this.persistence=this._c(e),await this.persistence.start(),this.localStore=this.wc(e),this.gcScheduler=this.mc(e,this.localStore),this.indexBackfillerScheduler=this.gc(e,this.localStore)}mc(e,t){return null}gc(e,t){return null}wc(e){return function(e,t,n,i){return new Cu(e,t,n,i)}(this.persistence,new Su,e.initialUser,this.wt)}_c(e){return new bu(_u.Ms,this.wt)}dc(e){return new Ou}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Uh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>kh(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Mh.bind(null,this.syncEngine),await async function(e,t){const n=Qr(e);t?(n.lu.delete(2),await Ku(n)):t||(n.lu.add(2),await Hu(n),n._u.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new fh}createDatastore(e){const t=Vu(e.databaseInfo.databaseId),n=(i=e.databaseInfo,new Fu(i));var i;return function(e,t,n,i){return new qu(e,t,n,i)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,i=e.asyncQueue,s=e=>kh(this.syncEngine,e,0),r=Lu.V()?new Lu:new Pu,new zu(t,n,i,s,r);var t,n,i,s,r}createSyncEngine(e,t){return function(e,t,n,i,s,r,o){const a=new _h(e,t,n,i,s,r);return o&&(a.ac=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=Qr(e);$r("RemoteStore","RemoteStore shutting down."),t.lu.add(5),await Hu(t),t.du.shutdown(),t._u.set("Unknown")}(this.remoteStore)}}class Vh{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class jh{constructor(e,t,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Vr.UNAUTHENTICATED,this.clientId=class{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=oo(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%e.length))}return n}}.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{$r("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>($r("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Jr(Xr.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Yr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=ch(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Bh(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){return e.offlineComponents||($r("FirestoreClient","Using default OfflineComponentProvider"),await async function(e,t){e.asyncQueue.verifyOperationInProgress(),$r("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener((async e=>{i.isEqual(e)||(await ku(t.localStore,e),i=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e.offlineComponents=t}(e,new Fh)),e.offlineComponents}(e);$r("FirestoreClient","Initializing OnlineComponentProvider");const i=await e.getConfiguration();await t.initialize(n,i),e.setCredentialChangeListener((e=>rh(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>rh(t.remoteStore,n))),e.onlineComponents=t}async function qh(e){const t=await async function(e){return e.onlineComponents||($r("FirestoreClient","Using default OnlineComponentProvider"),await Bh(e,new Uh)),e.onlineComponents}(e),n=t.eventManager;return n.onListen=Th.bind(null,t.syncEngine),n.onUnlisten=Sh.bind(null,t.syncEngine),n}function $h(e,t,n={}){const i=new Yr;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,i,s){const r=new Vh({next:n=>{t.enqueueAndForget((()=>async function(e,t){const n=Qr(e),i=t.query;let s=!1;const r=n.queries.get(i);if(r){const e=r.listeners.indexOf(t);e>=0&&(r.listeners.splice(e,1),s=0===r.listeners.length)}if(s)return n.queries.delete(i),n.onUnlisten(i)}(e,o))),n.fromCache&&"server"===i.source?s.reject(new Jr(Xr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):s.resolve(n)},error:e=>s.reject(e)}),o=new yh(n,r,{includeMetadataChanges:!0,Du:!0});return async function(e,t){const n=Qr(e),i=t.query;let s=!1,r=n.queries.get(i);if(r||(s=!0,r=new dh),s)try{r.Iu=await n.onListen(i)}catch(e){const n=ch(e,`Initialization of query '${Ma(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,r),r.listeners.push(t),t.Eu(n.onlineState),r.Iu&&t.Au(r.Iu)&&mh(n)}(e,o)}(await qh(e),e.asyncQueue,t,n,i))),i.promise}const zh=new Map;function Kh(e){if(mo.isDocumentKey(e))throw new Jr(Xr.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Hh(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Jr(Xr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=function(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Gr()}(e);throw new Jr(Xr.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}class Gh{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Jr(Xr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Jr(Xr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,function(e,t,n,i){if(!0===t&&!0===i)throw new Jr(Xr.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Wh{constructor(e,t,n){this._authCredentials=t,this._appCheckCredentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Gh({}),this._settingsFrozen=!1,e instanceof Bo?this._databaseId=e:(this._app=e,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Jr(Xr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bo(e.options.projectId)}(e))}get app(){if(!this._app)throw new Jr(Xr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Jr(Xr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Gh(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new eo;switch(e.type){case"gapi":const t=e.client;return Wr(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new io(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new Jr(Xr.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=zh.get(e);t&&($r("ComponentProvider","Removing Datastore"),zh.delete(e),t.terminate())}(this),Promise.resolve()}}class Qh{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Jh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Qh(this.firestore,e,this._key)}}class Xh{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Xh(this.firestore,e,this._query)}}class Jh extends Xh{constructor(e,t,n){super(e,t,ka(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Qh(this.firestore,null,new mo(e))}withConverter(e){return new Jh(this.firestore,e,this._path)}}function Yh(e,t,...n){if(e=_(e),function(e,t,n){if(!n)throw new Jr(Xr.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}("collection","path",t),e instanceof Wh){const i=fo.fromString(t,...n);return Kh(i),new Jh(e,null,i)}{if(!(e instanceof Qh||e instanceof Jh))throw new Jr(Xr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(fo.fromString(t,...n));return Kh(i),new Jh(e.firestore,null,i)}}class Zh{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new ju(this,"async_queue_retry"),this.Kc=()=>{const e=Uu();e&&$r("AsyncQueue","Visibility state changed to "+e.visibilityState),this.So.Eo()};const e=Uu();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const t=Uu();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise((()=>{}));const t=new Yr;return this.Qc((()=>this.Fc&&this.Uc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Mc.push(e),this.jc())))}async jc(){if(0!==this.Mc.length){try{await this.Mc[0](),this.Mc.shift(),this.So.reset()}catch(e){if(!Eo(e))throw e;$r("AsyncQueue","Operation failed with retryable error: "+e)}this.Mc.length>0&&this.So.Io((()=>this.jc()))}}Qc(e){const t=this.Oc.then((()=>(this.Lc=!0,e().catch((e=>{this.Bc=e,this.Lc=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw zr("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.Lc=!1,e))))));return this.Oc=t,t}enqueueAfterDelay(e,t,n){this.Gc(),this.qc.indexOf(e)>-1&&(t=0);const i=ah.createAndSchedule(this,e,t,n,(e=>this.Wc(e)));return this.$c.push(i),i}Gc(){this.Bc&&Gr()}verifyOperationInProgress(){}async zc(){let e;do{e=this.Oc,await e}while(e!==this.Oc)}Hc(e){for(const t of this.$c)if(t.timerId===e)return!0;return!1}Jc(e){return this.zc().then((()=>{this.$c.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.$c)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.zc()}))}Yc(e){this.qc.push(e)}Wc(e){const t=this.$c.indexOf(e);this.$c.splice(t,1)}}class el extends Wh{constructor(e,t,n){super(e,t,n),this.type="firestore",this._queue=new Zh,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||tl(this),this._firestoreClient.terminate()}}function tl(e){var t;const n=e._freezeSettings(),i=function(e,t,n,i){return new jo(e,t,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,i.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new jh(e._authCredentials,e._appCheckCredentials,e._queue,i)}class nl{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new go(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class il{constructor(e){this._byteString=e}static fromBase64String(e){try{return new il(Oo.fromBase64String(e))}catch(e){throw new Jr(Xr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new il(Oo.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class sl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Jr(Xr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Jr(Xr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ao(this._lat,e._lat)||ao(this._long,e._long)}}const rl=new RegExp("[~\\*/\\[\\]]");function ol(e,t,n,i,s){const r=i&&!i.isEmpty(),o=void 0!==s;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${i}`),o&&(c+=` in document ${s}`),c+=")"),new Jr(Xr.INVALID_ARGUMENT,a+e+c)}class al{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Qh(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new cl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ul("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class cl extends al{data(){return super.data()}}function ul(e,t){return"string"==typeof t?function(e,t,n){if(t.search(rl)>=0)throw ol(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new nl(...t.split("."))._internalPath}catch(i){throw ol(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}(e,t):t instanceof nl?t._internalPath:t._delegate._internalPath}class hl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ll extends al{constructor(e,t,n,i,s,r){super(e,t,n,i,r),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new dl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(ul("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class dl extends ll{data(e={}){return super.data(e)}}class fl{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new hl(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new dl(this._firestore,this._userDataWriter,n.key,n,new hl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Jr(Xr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>({type:"added",doc:new dl(e._firestore,e._userDataWriter,n.doc.key,n.doc,new hl(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:t++})))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const i=new dl(e._firestore,e._userDataWriter,t.doc.key,t.doc,new hl(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let s=-1,r=-1;return 0!==t.type&&(s=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),r=n.indexOf(t.doc.key)),{type:pl(t.type),doc:i,oldIndex:s,newIndex:r}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function pl(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Gr()}}class gl{}function ml(e,...t){for(const n of t)e=n._apply(e);return e}class yl extends gl{constructor(e,t){super(),this.fa=e,this.wa=t,this.type="orderBy"}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Jr(Xr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const i=new Ea(t,n);return function(e,t){if(null===Aa(e)){const n=Na(e);null!==n&&function(e,t,n){if(!n.isEqual(t))throw new Jr(Xr.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}(0,n,t.field)}}(e,i),i}(e._query,this.fa,this.wa);return new Xh(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Ca(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function vl(e,t="asc"){const n=t,i=ul("orderBy",e);return new yl(i,n)}class wl extends gl{constructor(e,t,n){super(),this.type=e,this.ma=t,this.ga=n}_apply(e){return new Xh(e.firestore,e.converter,Oa(e._query,this.ma,this.ga))}}function Il(e){return function(e,t){if(t<=0)throw new Jr(Xr.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}("limit",e),new wl("limit",e,"F")}class bl extends class{convertValue(e,t="none"){switch(Ko(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Mo(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(xo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Gr()}}convertObject(e,t){const n={};return So(e.fields,((e,i)=>{n[e]=this.convertValue(i,t)})),n}convertGeoPoint(e){return new sl(Mo(e.latitude),Mo(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Uo(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Vo(e));default:return null}}convertTimestamp(e){const t=Lo(e);return new uo(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=fo.fromString(e);Wr(eu(n));const i=new Bo(n.get(1),n.get(3)),s=new mo(n.popFirst(5));return i.isEqual(t)||zr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}{constructor(e){super(),this.firestore=e}convertBytes(e){return new il(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Qh(this.firestore,null,t)}}function El(e){e=Hh(e,Xh);const t=Hh(e.firestore,el),n=function(e){return e._firestoreClient||tl(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}(t),i=new bl(t);return function(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Jr(Xr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(e._query),$h(n,e._query).then((n=>new fl(t,i,e,n)))}function _l(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n}!function(e,t=!0){jr="9.9.0",ae(new T("firestore",((e,{options:n})=>{const i=e.getProvider("app").getImmediate(),s=new el(i,new to(e.getProvider("auth-internal")),new ro(e.getProvider("app-check-internal")));return n=Object.assign({useFetchStreams:t},n),s._setSettings(n),s}),"PUBLIC")),fe(Ur,"3.4.12",e),fe(Ur,"3.4.12","esm2017")}(),Object.create,Object.create;const Tl=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Sl=new f("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Cl=new M("@firebase/auth");function kl(e,...t){Cl.logLevel<=N.ERROR&&Cl.error(`Auth (9.9.0): ${e}`,...t)}function Al(e,...t){throw Rl(e,...t)}function Nl(e,...t){return Rl(e,...t)}function Rl(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return Sl.create(e,...t)}function Dl(e,t,...n){if(!e)throw Rl(t,...n)}function Ol(e){const t="INTERNAL ASSERTION FAILED: "+e;throw kl(t),new Error(t)}function Pl(e,t){e||Ol(t)}const Ll=new Map;function Ml(e){Pl(e instanceof Function,"Expected a class definition");let t=Ll.get(e);return t?(Pl(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Ll.set(e,t),t)}function xl(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Fl(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Ul{constructor(e,t){this.shortDelay=e,this.longDelay=t,Pl(t>e,"Short delay should be less than long delay!"),this.isMobile=o()||c()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Fl()||"https:"===Fl()||a()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function Vl(e,t){Pl(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class jl{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void Ol("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void Ol("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void Ol("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Bl={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},ql=new Ul(3e4,6e4);function $l(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function zl(e,t,n,i,s={}){return Kl(e,s,(async()=>{let s={},r={};i&&("GET"===t?r=i:s={body:JSON.stringify(i)});const o=y(Object.assign({key:e.config.apiKey},r)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),jl.fetch()(Gl(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},s))}))}async function Kl(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},Bl),t);try{const t=new Wl(e),s=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const r=await s.json();if("needConfirmation"in r)throw Ql(e,"account-exists-with-different-credential",r);if(s.ok&&!("errorMessage"in r))return r;{const t=s.ok?r.errorMessage:r.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Ql(e,"credential-already-in-use",r);if("EMAIL_EXISTS"===n)throw Ql(e,"email-already-in-use",r);if("USER_DISABLED"===n)throw Ql(e,"user-disabled",r);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(e,t,n){const i=Object.assign(Object.assign({},Tl()),{[t]:n});return new f("auth","Firebase",i).create(t,{appName:e.name})}(e,a,o);Al(e,a)}}catch(t){if(t instanceof d)throw t;Al(e,"network-request-failed")}}async function Hl(e,t,n,i,s={}){const r=await zl(e,t,n,i,s);return"mfaPendingCredential"in r&&Al(e,"multi-factor-auth-required",{_serverResponse:r}),r}function Gl(e,t,n,i){const s=`${t}${n}?${i}`;return e.config.emulator?Vl(e.config,s):`${e.config.apiScheme}://${s}`}class Wl{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Nl(this.auth,"network-request-failed"))),ql.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ql(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const s=Nl(e,t,i);return s.customData._tokenResponse=n,s}function Xl(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function Jl(e){return 1e3*Number(e)}function Yl(e){var t;const[i,s,r]=e.split(".");if(void 0===i||void 0===s||void 0===r)return kl("JWT malformed, contained fewer than 3 sections"),null;try{const e=function(e){try{return n.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null}(s);return e?JSON.parse(e):(kl("Failed to decode base64 JWT payload"),null)}catch(e){return kl("Caught error parsing JWT payload as JSON",null===(t=e)||void 0===t?void 0:t.toString()),null}}async function Zl(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof d&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class ed{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){var e;try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===(null===(e=t)||void 0===e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class td{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Xl(this.lastLoginAt),this.creationTime=Xl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function nd(e){var t;const n=e.auth,i=await e.getIdToken(),s=await Zl(e,async function(e,t){return zl(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:i}));Dl(null==s?void 0:s.users.length,n,"internal-error");const r=s.users[0];e._notifyReloadListener(r);const o=(null===(t=r.providerUserInfo)||void 0===t?void 0:t.length)?r.providerUserInfo.map((e=>{var{providerId:t}=e,n=_l(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=e.providerData,u=o,[...c.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var c,u;const h=e.isAnonymous,l=!(e.email&&r.passwordHash||(null==a?void 0:a.length)),d=!!h&&l,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new td(r.createdAt,r.lastLoginAt),isAnonymous:d};Object.assign(e,f)}class id{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Dl(e.idToken,"internal-error"),Dl(void 0!==e.idToken,"internal-error"),Dl(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=Yl(e);return Dl(t,"internal-error"),Dl(void 0!==t.exp,"internal-error"),Dl(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return Dl(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:s}=await async function(e,t){const n=await Kl(e,{},(async()=>{const n=y({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:s}=e.config,r=Gl(e,i,"/v1/token",`key=${s}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",jl.fetch()(r,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:s}=t,r=new id;return n&&(Dl("string"==typeof n,"internal-error",{appName:e}),r.refreshToken=n),i&&(Dl("string"==typeof i,"internal-error",{appName:e}),r.accessToken=i),s&&(Dl("number"==typeof s,"internal-error",{appName:e}),r.expirationTime=s),r}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new id,this.toJSON())}_performRefresh(){return Ol("not implemented")}}function sd(e,t){Dl("string"==typeof e||void 0===e,"internal-error",{appName:t})}class rd{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,s=_l(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ed(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new td(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Zl(this,this.stsTokenManager.getToken(this.auth,e));return Dl(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=_(e),i=await n.getIdToken(t),s=Yl(i);Dl(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const r="object"==typeof s.firebase?s.firebase:void 0,o=null==r?void 0:r.sign_in_provider;return{claims:s,token:i,authTime:Xl(Jl(s.auth_time)),issuedAtTime:Xl(Jl(s.iat)),expirationTime:Xl(Jl(s.exp)),signInProvider:o||null,signInSecondFactor:(null==r?void 0:r.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=_(e);await nd(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Dl(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new rd(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){Dl(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await nd(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Zl(this,async function(e,t){return zl(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,s,r,o,a,c,u;const h=null!==(n=t.displayName)&&void 0!==n?n:void 0,l=null!==(i=t.email)&&void 0!==i?i:void 0,d=null!==(s=t.phoneNumber)&&void 0!==s?s:void 0,f=null!==(r=t.photoURL)&&void 0!==r?r:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:w,isAnonymous:I,providerData:b,stsTokenManager:E}=t;Dl(v&&E,e,"internal-error");const _=id.fromJSON(this.name,E);Dl("string"==typeof v,e,"internal-error"),sd(h,e.name),sd(l,e.name),Dl("boolean"==typeof w,e,"internal-error"),Dl("boolean"==typeof I,e,"internal-error"),sd(d,e.name),sd(f,e.name),sd(p,e.name),sd(g,e.name),sd(m,e.name),sd(y,e.name);const T=new rd({uid:v,auth:e,email:l,emailVerified:w,displayName:h,isAnonymous:I,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:_,createdAt:m,lastLoginAt:y});return b&&Array.isArray(b)&&(T.providerData=b.map((e=>Object.assign({},e)))),g&&(T._redirectEventId=g),T}static async _fromIdTokenResponse(e,t,n=!1){const i=new id;i.updateFromServerResponse(t);const s=new rd({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await nd(s),s}}class od{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}od.type="NONE";const ad=od;function cd(e,t,n){return`firebase:${e}:${t}:${n}`}class ud{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=cd(this.userKey,i.apiKey,s),this.fullPersistenceKey=cd("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?rd._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new ud(Ml(ad),e,n);const i=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let s=i[0]||Ml(ad);const r=cd(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(r);if(t){const i=rd._fromJSON(e,t);n!==s&&(o=i),s=n;break}}catch(e){}const a=i.filter((e=>e._shouldAllowMigration));return s._shouldAllowMigration&&a.length?(s=a[0],o&&await s._set(r,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==s)try{await e._remove(r)}catch(e){}}))),new ud(s,e,n)):new ud(s,e,n)}}function hd(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(pd(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ld(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(md(t))return"Blackberry";if(yd(t))return"Webos";if(dd(t))return"Safari";if((t.includes("chrome/")||fd(t))&&!t.includes("edge/"))return"Chrome";if(gd(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function ld(e=r()){return/firefox\//i.test(e)}function dd(e=r()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function fd(e=r()){return/crios\//i.test(e)}function pd(e=r()){return/iemobile/i.test(e)}function gd(e=r()){return/android/i.test(e)}function md(e=r()){return/blackberry/i.test(e)}function yd(e=r()){return/webos/i.test(e)}function vd(e=r()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function wd(e=r()){return vd(e)||gd(e)||yd(e)||md(e)||/windows phone/i.test(e)||pd(e)}function Id(e,t=[]){let n;switch(e){case"Browser":n=hd(r());break;case"Worker":n=`${hd(r())}-${e}`;break;default:n=e}return`${n}/JsCore/9.9.0/${t.length?t.join(","):"FirebaseCore-web"}`}class bd{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,i)=>{try{n(e(t))}catch(e){i(e)}}));n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){var t;if(this.auth.currentUser===e)return;const n=[];try{for(const t of this.queue)await t(e),t.onAbort&&n.push(t.onAbort)}catch(e){n.reverse();for(const e of n)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===(t=e)||void 0===t?void 0:t.message})}}}class Ed{constructor(e,t,n){this.app=e,this.heartbeatServiceProvider=t,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Td(this),this.idTokenSubscription=new Td(this),this.beforeStateQueue=new bd(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Sl,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ml(t)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await ud.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,r=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==r||!(null==o?void 0:o.user)||(i=o.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(e){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Dl(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){var t;try{await nd(e)}catch(e){if("auth/network-request-failed"!==(null===(t=e)||void 0===t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?_(e):null;return t&&Dl(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Dl(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(Ml(e))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new f("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ml(e)||this._popupRedirectResolver;Dl(t,this,"argument-error"),this.redirectPersistenceManager=await ud.create(this,[Ml(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const s="function"==typeof t?t:t.next.bind(t),r=this._isInitialized?Promise.resolve():this._initializationPromise;return Dl(r,this,"internal-error"),r.then((()=>s(this.currentUser))),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Dl(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Id(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());return n&&(t["X-Firebase-Client"]=n),t}}function _d(e){return _(e)}class Td{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new I(e,void 0);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return Dl(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}class Sd{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ol("not implemented")}_getIdTokenResponse(e){return Ol("not implemented")}_linkToIdToken(e,t){return Ol("not implemented")}_getReauthenticationResolver(e){return Ol("not implemented")}}class Cd extends Sd{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Cd(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Cd(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return async function(e,t){return Hl(e,"POST","/v1/accounts:signInWithPassword",$l(e,t))}(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return Hl(e,"POST","/v1/accounts:signInWithEmailLink",$l(e,t))}(e,{email:this._email,oobCode:this._password});default:Al(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return async function(e,t){return zl(e,"POST","/v1/accounts:update",t)}(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return Hl(e,"POST","/v1/accounts:signInWithEmailLink",$l(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Al(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function kd(e,t){return Hl(e,"POST","/v1/accounts:signInWithIdp",$l(e,t))}class Ad extends Sd{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ad(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Al("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,s=_l(t,["providerId","signInMethod"]);if(!n||!i)return null;const r=new Ad(n,i);return r.idToken=s.idToken||void 0,r.accessToken=s.accessToken||void 0,r.secret=s.secret,r.nonce=s.nonce,r.pendingToken=s.pendingToken||null,r}_getIdTokenResponse(e){return kd(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,kd(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,kd(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=y(t)}return e}}const Nd={USER_NOT_FOUND:"user-not-found"};class Rd extends Sd{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Rd({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Rd({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Hl(e,"POST","/v1/accounts:signInWithPhoneNumber",$l(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Hl(e,"POST","/v1/accounts:signInWithPhoneNumber",$l(e,t));if(n.temporaryProof)throw Ql(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Hl(e,"POST","/v1/accounts:signInWithPhoneNumber",$l(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Nd)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:s}=e;return n||t||i||s?new Rd({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:s}):null}}class Dd{constructor(e){var t,n,i,s,r,o;const a=v(w(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,h=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);Dl(c&&u&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=u,this.continueUrl=null!==(s=a.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(r=a.languageCode)&&void 0!==r?r:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=v(w(e)).link,n=t?v(w(t)).deep_link_id:null,i=v(w(e)).deep_link_id;return(i?v(w(i)).link:null)||i||n||t||e}(e);try{return new Dd(t)}catch(e){return null}}}class Od{constructor(){this.providerId=Od.PROVIDER_ID}static credential(e,t){return Cd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Dd.parseLink(t);return Dl(n,"argument-error"),Cd._fromEmailAndCode(e,n.code,n.tenantId)}}Od.PROVIDER_ID="password",Od.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Od.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Pd{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ld extends Pd{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Md extends Ld{constructor(){super("facebook.com")}static credential(e){return Ad._fromParams({providerId:Md.PROVIDER_ID,signInMethod:Md.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Md.credentialFromTaggedObject(e)}static credentialFromError(e){return Md.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Md.credential(e.oauthAccessToken)}catch(e){return null}}}Md.FACEBOOK_SIGN_IN_METHOD="facebook.com",Md.PROVIDER_ID="facebook.com";class xd extends Ld{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ad._fromParams({providerId:xd.PROVIDER_ID,signInMethod:xd.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return xd.credentialFromTaggedObject(e)}static credentialFromError(e){return xd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return xd.credential(t,n)}catch(e){return null}}}xd.GOOGLE_SIGN_IN_METHOD="google.com",xd.PROVIDER_ID="google.com";class Fd extends Ld{constructor(){super("github.com")}static credential(e){return Ad._fromParams({providerId:Fd.PROVIDER_ID,signInMethod:Fd.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fd.credentialFromTaggedObject(e)}static credentialFromError(e){return Fd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Fd.credential(e.oauthAccessToken)}catch(e){return null}}}Fd.GITHUB_SIGN_IN_METHOD="github.com",Fd.PROVIDER_ID="github.com";class Ud extends Ld{constructor(){super("twitter.com")}static credential(e,t){return Ad._fromParams({providerId:Ud.PROVIDER_ID,signInMethod:Ud.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ud.credentialFromTaggedObject(e)}static credentialFromError(e){return Ud.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Ud.credential(t,n)}catch(e){return null}}}Ud.TWITTER_SIGN_IN_METHOD="twitter.com",Ud.PROVIDER_ID="twitter.com";class Vd{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const s=await rd._fromIdTokenResponse(e,n,i),r=jd(n);return new Vd({user:s,providerId:r,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=jd(n);return new Vd({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function jd(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Bd extends d{constructor(e,t,n,i){var s;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Bd.prototype),this.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new Bd(e,t,n,i)}}function qd(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Bd._fromErrorAndOperation(e,n,t,i);throw n}))}new WeakMap;const $d="__sak";class zd{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem($d,"1"),this.storage.removeItem($d),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Kd extends zd{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=r();return dd(e)||vd(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=wd(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);u()&&10===document.documentMode&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Kd.type="LOCAL";const Hd=Kd;class Gd extends zd{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Gd.type="SESSION";const Wd=Gd;class Qd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Qd(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:s}=t.data,r=this.handlersMap[i];if(!(null==r?void 0:r.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(r).map((async e=>e(t.origin,s))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Xd(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}Qd.receivers=[];class Jd{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,r;return new Promise(((o,a)=>{const c=Xd("",20);i.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);r={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),s=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(s),o(t.data.response);break;default:clearTimeout(u),clearTimeout(s),a(new Error("invalid_response"))}}},this.handlers.add(r),i.port1.addEventListener("message",r.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])})).finally((()=>{r&&this.removeMessageHandler(r)}))}}function Yd(){return window}function Zd(){return void 0!==Yd().WorkerGlobalScope&&"function"==typeof Yd().importScripts}const ef="firebaseLocalStorageDb",tf="firebaseLocalStorage",nf="fbase_key";class sf{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function rf(e,t){return e.transaction([tf],t?"readwrite":"readonly").objectStore(tf)}function of(){const e=indexedDB.open(ef,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(tf,{keyPath:nf})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(tf)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(ef);return new sf(e).toPromise()}(),t(await of()))}))}))}async function af(e,t,n){const i=rf(e,!0).put({[nf]:t,value:n});return new sf(i).toPromise()}function cf(e,t){const n=rf(e,!0).delete(t);return new sf(n).toPromise()}class uf{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await of()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Zd()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qd._getInstance(Zd()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Jd(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await of();return await af(e,$d,"1"),await cf(e,$d),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>af(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=rf(e,!1).get(t),i=await new sf(n).toPromise();return void 0===i?null:i.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>cf(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=rf(e,!1).getAll();return new sf(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}uf.type="LOCAL";const hf=uf;function lf(e){return`__${e}${Math.floor(1e6*Math.random())}`}lf("rcb"),new Ul(3e4,6e4);class df{constructor(e){this.providerId=df.PROVIDER_ID,this.auth=_d(e)}verifyPhoneNumber(e,t){return async function(e,t,n){var i;const s=await n.verify();try{let r;if(Dl("string"==typeof s,e,"argument-error"),Dl("recaptcha"===n.type,e,"argument-error"),r="string"==typeof t?{phoneNumber:t}:t,"session"in r){const t=r.session;if("phoneNumber"in r){Dl("enroll"===t.type,e,"internal-error");const n=await function(e,t){return zl(e,"POST","/v2/accounts/mfaEnrollment:start",$l(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,recaptchaToken:s}});return n.phoneSessionInfo.sessionInfo}{Dl("signin"===t.type,e,"internal-error");const n=(null===(i=r.multiFactorHint)||void 0===i?void 0:i.uid)||r.multiFactorUid;Dl(n,e,"missing-multi-factor-info");const o=await function(e,t){return zl(e,"POST","/v2/accounts/mfaSignIn:start",$l(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:s}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return zl(e,"POST","/v1/accounts:sendVerificationCode",$l(e,t))}(e,{phoneNumber:r.phoneNumber,recaptchaToken:s});return t}}finally{n._reset()}}(this.auth,e,_(t))}static credential(e,t){return Rd._fromVerification(e,t)}static credentialFromResult(e){const t=e;return df.credentialFromTaggedObject(t)}static credentialFromError(e){return df.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?Rd._fromTokenResponse(t,n):null}}df.PROVIDER_ID="phone",df.PHONE_SIGN_IN_METHOD="phone";class ff extends Sd{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return kd(e,this._buildIdpRequest())}_linkToIdToken(e,t){return kd(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return kd(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function pf(e){return async function(e,t,n=!1){const i="signIn",s=await qd(e,i,t),r=await Vd._fromIdTokenResponse(e,i,s);return n||await e._updateCurrentUser(r.user),r}(e.auth,new ff(e),e.bypassAuthState)}function gf(e){const{auth:t,user:n}=e;return Dl(n,t,"internal-error"),async function(e,t,n=!1){var i;const{auth:s}=e,r="reauthenticate";try{const i=await Zl(e,qd(s,r,t,e),n);Dl(i.idToken,s,"internal-error");const o=Yl(i.idToken);Dl(o,s,"internal-error");const{sub:a}=o;return Dl(e.uid===a,s,"user-mismatch"),Vd._forOperation(e,r,i)}catch(e){throw"auth/user-not-found"===(null===(i=e)||void 0===i?void 0:i.code)&&Al(s,"user-mismatch"),e}}(n,new ff(e),e.bypassAuthState)}async function mf(e){const{auth:t,user:n}=e;return Dl(n,t,"internal-error"),async function(e,t,n=!1){const i=await Zl(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Vd._forOperation(e,"link",i)}(n,new ff(e),e.bypassAuthState)}class yf{constructor(e,t,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:s,error:r,type:o}=e;if(r)return void this.reject(r);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return pf;case"linkViaPopup":case"linkViaRedirect":return mf;case"reauthViaPopup":case"reauthViaRedirect":return gf;default:Al(this.auth,"internal-error")}}resolve(e){Pl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Pl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const vf=new Ul(2e3,1e4);class wf extends yf{constructor(e,t,n,i,s){super(e,t,i,s),this.provider=n,this.authWindow=null,this.pollId=null,wf.currentPopupAction&&wf.currentPopupAction.cancel(),wf.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Dl(e,this.auth,"internal-error"),e}async onExecution(){Pl(1===this.filter.length,"Popup operations only handle one event");const e=Xd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Nl(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Nl(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,wf.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Nl(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(e,vf.get())};e()}}wf.currentPopupAction=null;const If=new Map;class bf extends yf{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=If.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return cd("pendingRedirect",e.config.apiKey,e.name)}(t),i=function(e){return Ml(e._redirectPersistence)}(e);if(!await i._isAvailable())return!1;const s="true"===await i._get(n);return await i._remove(n),s}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}If.set(this.auth._key(),e)}return this.bypassAuthState||If.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Ef(e,t){If.set(e._key(),t)}async function _f(e,t,n=!1){const i=_d(e),s=function(e,t){return t?Ml(t):(Dl(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(i,t),r=new bf(i,s,n),o=await r.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}class Tf{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Cf(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Cf(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Nl(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Sf(e))}saveEventToCache(e){this.cachedEventUids.add(Sf(e)),this.lastProcessedEventTime=Date.now()}}function Sf(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Cf({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const kf=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Af=/^https?/;function Nf(e){const t=xl(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const s=new URL(e);return""===s.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===i}if(!Af.test(n))return!1;if(kf.test(e))return i===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}const Rf=new Ul(3e4,6e4);function Df(){const e=Yd().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let Of=null;function Pf(e){return Of=Of||function(e){return new Promise(((t,n)=>{var i,s,r,o;function a(){Df(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Df(),n(Nl(e,"network-request-failed"))},timeout:Rf.get()})}if(null===(s=null===(i=Yd().gapi)||void 0===i?void 0:i.iframes)||void 0===s?void 0:s.Iframe)t(gapi.iframes.getContext());else{if(!(null===(r=Yd().gapi)||void 0===r?void 0:r.load)){const t=lf("iframefcb");return Yd()[t]=()=>{gapi.load?a():n(Nl(e,"network-request-failed"))},(o=`https://apis.google.com/js/api.js?onload=${t}`,new Promise(((e,t)=>{const n=document.createElement("script");n.setAttribute("src",o),n.onload=e,n.onerror=e=>{const n=Nl("internal-error");n.customData=e,t(n)},n.type="text/javascript",n.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(n)}))).catch((e=>n(e)))}a()}})).catch((e=>{throw Of=null,e}))}(e),Of}const Lf=new Ul(5e3,15e3),Mf={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xf=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ff(e){const t=e.config;Dl(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Vl(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,i={apiKey:t.apiKey,appName:e.name,v:le},s=xf.get(e.config.apiHost);s&&(i.eid=s);const r=e._getFrameworks();return r.length&&(i.fw=r.join(",")),`${n}?${y(i).slice(1)}`}const Uf={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Vf{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function jf(e,t,n,i,s,r){Dl(e.config.authDomain,e,"auth-domain-config-required"),Dl(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:le,eventId:s};if(t instanceof Pd){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(r||{}))o[e]=t}if(t instanceof Ld){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];return`${function({config:e}){return e.emulator?Vl(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${y(a).slice(1)}`}const Bf="webStorageSupport",qf=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Wd,this._completeRedirectFn=_f,this._overrideRedirectResult=Ef}async _openPopup(e,t,n,i){var s;return Pl(null===(s=this.eventManagers[e._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()"),function(e,t,n,i=500,s=600){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let c="";const u=Object.assign(Object.assign({},Uf),{width:i.toString(),height:s.toString(),top:o,left:a}),h=r().toLowerCase();n&&(c=fd(h)?"_blank":n),ld(h)&&(t=t||"http://localhost",u.scrollbars="yes");const l=Object.entries(u).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=r()){var t;return vd(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(h)&&"_self"!==c)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(t||"",c),new Vf(null);const d=window.open(t||"",c,l);Dl(d,e,"popup-blocked");try{d.focus()}catch(e){}return new Vf(d)}(e,jf(e,t,n,xl(),i),Xd())}async _openRedirect(e,t,n,i){var s;return await this._originValidation(e),s=jf(e,t,n,xl(),i),Yd().location.href=s,new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Pl(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await Pf(e),n=Yd().gapi;return Dl(n,e,"internal-error"),t.open({where:document.body,url:Ff(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Mf,dontclear:!0},(t=>new Promise((async(n,i)=>{await t.restyle({setHideOnLeave:!1});const s=Nl(e,"network-request-failed"),r=Yd().setTimeout((()=>{i(s)}),Lf.get());function o(){Yd().clearTimeout(r),n(t)}t.ping(o).then(o,(()=>{i(s)}))}))))}(e),n=new Tf(e);return t.register("authEvent",(t=>(Dl(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Bf,{type:Bf},(n=>{var i;const s=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i.webStorageSupport;void 0!==s&&t(!!s),Al(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return zl(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(Nf(e))return}catch(e){}Al(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return wd()||dd()||vd()}};var $f,zf="@firebase/auth",Kf="0.20.5";class Hf{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Dl(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}$f="Browser",ae(new T("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),{apiKey:s,authDomain:r}=n.options;return((e,n)=>{Dl(s&&!s.includes(":"),"invalid-api-key",{appName:e.name}),Dl(!(null==r?void 0:r.includes(":")),"argument-error",{appName:e.name});const i={apiKey:s,authDomain:r,clientPlatform:$f,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Id($f)},o=new Ed(e,n,i);return function(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Ml);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}(o,t),o})(n,i)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),ae(new T("auth-internal",(e=>(e=>new Hf(e))(_d(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),fe(zf,Kf,void 0),fe(zf,Kf,"esm2017");const Gf="firebasestorage.googleapis.com";class Wf extends d{constructor(e,t){super(Qf(e),`Firebase Storage: ${t} (${Qf(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Wf.prototype)}_codeEquals(e){return Qf(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function Qf(e){return"storage/"+e}function Xf(e){return new Wf("invalid-argument",e)}function Jf(){return new Wf("app-deleted","The Firebase app was deleted.")}class Yf{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=Yf.makeFromUrl(e,t)}catch(t){return new Yf(e,"")}if(""===n.path)return n;throw new Wf("invalid-default-bucket","Invalid default bucket '"+e+"'.")}static makeFromUrl(e,t){let n=null;const i="([A-Za-z0-9.\\-_]+)",s=new RegExp("^gs://"+i+"(/(.*))?$","i");function r(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),a=[{regex:s,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:r},{regex:new RegExp(`^https?://${t===Gf?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:r}];for(let t=0;t<a.length;t++){const i=a[t],s=i.regex.exec(e);if(s){const e=s[i.indices.bucket];let t=s[i.indices.path];t||(t=""),n=new Yf(e,t),i.postModify(n);break}}if(null==n)throw function(e){return new Wf("invalid-url","Invalid URL '"+e+"'.")}(e);return n}}class Zf{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function ep(e,t,n,i){if(i<t)throw Xf(`Invalid value for '${e}'. Expected ${t} or greater.`);if(i>n)throw Xf(`Invalid value for '${e}'. Expected ${n} or less.`)}var tp;!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(tp||(tp={}));class np{constructor(e,t,n,i,s,r,o,a,c,u,h){this.url_=e,this.method_=t,this.headers_=n,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=r,this.callback_=o,this.errorCallback_=a,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=(e,t)=>{const n=this.resolve_,i=this.reject_,s=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(s,s.getResponse());!function(e){return void 0!==e}(e)?n():n(e)}catch(e){i(e)}else if(null!==s){const e=new Wf("unknown","An unknown error occurred, please check the error payload for server response.");e.serverResponse=s.getErrorText(),this.errorCallback_?i(this.errorCallback_(s,e)):i(e)}else t.canceled?i(this.appDelete_?Jf():new Wf("canceled","User canceled the upload/download.")):i(new Wf("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))};this.canceled_?e(0,new ip(!1,null,!0)):this.backoffId_=function(e,t,n){let i=1,s=null,r=null,o=!1,a=0;function c(){return 2===a}let u=!1;function h(...e){u||(u=!0,t.apply(null,e))}function l(t){s=setTimeout((()=>{s=null,e(f,c())}),t)}function d(){r&&clearTimeout(r)}function f(e,...t){if(u)return void d();if(e)return d(),void h.call(null,e,...t);if(c()||o)return d(),void h.call(null,e,...t);let n;i<64&&(i*=2),1===a?(a=2,n=0):n=1e3*(i+Math.random()),l(n)}let p=!1;function g(e){p||(p=!0,d(),u||(null!==s?(e||(a=2),clearTimeout(s),l(0)):e||(a=1)))}return l(0),r=setTimeout((()=>{o=!0,g(!0)}),n),g}(((e,t)=>{if(t)return void e(!1,new ip(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const i=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(i),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(i),this.pendingConnection_=null;const t=n.getErrorCode()===tp.NO_ERROR,s=n.getStatus();if(!t||this.isRetryStatusCode_(s)){const t=n.getErrorCode()===tp.ABORT;return void e(!1,new ip(!1,null,t))}const r=-1!==this.successCodes_.indexOf(s);e(!0,new ip(r,n))}))}),e,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const t=e>=500&&e<600,n=-1!==[408,429].indexOf(e),i=-1!==this.additionalRetryCodes_.indexOf(e);return t||n||i}}class ip{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}class sp{constructor(e,t){this._service=e,this._location=t instanceof Yf?t:Yf.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new sp(e,t)}get root(){const e=new Yf(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return function(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new Yf(this._location.bucket,e);return new sp(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new Wf("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function rp(e,t){const n=null==t?void 0:t.storageBucket;return null==n?null:Yf.makeFromBucketSpec(n,e)}class op{constructor(e,t,n,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=Gf,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?Yf.makeFromBucketSpec(i,this._host):rp(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=Yf.makeFromBucketSpec(this._url,e):this._bucket=rp(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){ep("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){ep("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new sp(this,e)}_makeRequest(e,t,n,i){if(this._deleted)return new Zf(Jf());{const s=function(e,t,n,i,s,r){const o=function(e){const t=encodeURIComponent;let n="?";for(const i in e)e.hasOwnProperty(i)&&(n=n+(t(i)+"=")+t(e[i])+"&");return n=n.slice(0,-1),n}(e.urlParams),a=e.url+o,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(c,r),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,i),new np(a,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s)}(e,this._appId,n,i,t,this._firebaseVersion);return this._requests.add(s),s.getPromise().then((()=>this._requests.delete(s)),(()=>this._requests.delete(s))),s}}async makeRequestWithTokens(e,t){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,i).getPromise()}}const ap="@firebase/storage",cp="0.9.9",up="storage";var hp,lp,dp,fp,pp;ae(new T(up,(function(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new op(n,i,s,t,le)}),"PUBLIC").setMultipleInstances(!0)),fe(ap,cp,""),fe(ap,cp,"esm2017");const gp={apiKey:"AIzaSyBvd9S50ayvisTxaVQR4c7tjkEBN3rdO3Q",authDomain:"underground-eve.firebaseapp.com",projectId:"underground-eve",storageBucket:"underground-eve.appspot.com",messagingSenderId:"1041403011395",appId:"1:1041403011395:web:d1a08391beef5a0bfdcff6",measurementId:"G-W4HDN06V2R"};pp=function(e=de()){return ce(e,"firestore").getImmediate()}(hp=function(e,t={}){"object"!=typeof t&&(t={name:t});const n=Object.assign({name:"[DEFAULT]",automaticDataCollectionEnabled:!1},t),i=n.name;if("string"!=typeof i||!i)throw ue.create("bad-app-name",{appName:String(i)});const s=se.get(i);if(s){if(g(e,s.options)&&g(n,s.config))return s;throw ue.create("duplicate-app",{appName:i})}const r=new k(i);for(const e of re.values())r.addComponent(e);const o=new he(e,n,r);return se.set(i,o),o}(gp)),dp=function(e=de()){const t=ce(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){const n=ce(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(g(n.getOptions(),null!=t?t:{}))return e;Al(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:qf,persistence:[hf,Hd,Wd]})}(hp),fp=function(e=de(),t){return ce(e=_(e),up).getImmediate({identifier:t})}(hp),lp=function(e=de()){const t=ce(e=_(e),it);return t.isInitialized()?t.getImmediate():function(e,t={}){const n=ce(e,it);if(n.isInitialized()){const e=n.getImmediate();if(g(t,n.getOptions()))return e;throw at.create("already-initialized")}return n.initialize({options:t})}(e)}(hp),function(){let e=JSON.parse(localStorage.getItem("we_user"));e||async function(e){var t;const n=_d(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Vd({user:n.currentUser,providerId:null,operationType:"signIn"});const i=await async function(e,t){return Hl(e,"POST","/v1/accounts:signUp",$l(e,t))}(n,{returnSecureToken:!0}),s=await Vd._fromIdTokenResponse(n,"signIn",i,!0);return await n._updateCurrentUser(s.user),s}(dp).then((async e=>{let t=await JSON.stringify(e),n=await JSON.stringify(gp);await localStorage.setItem("we_user",t),await localStorage.setItem("we_config",n)})).catch((e=>!1))}();var mp={app:hp,analytics:lp,database:pp,auth:dp,storage:fp};setTimeout((async()=>{await async function(){await async function(){try{const e=ml(Yh(mp.database,"/events"),vl("created_at","desc"),Il(3));await El(e).then((e=>{if(!(e.size>0))return!1;e.docs.forEach((e=>{const t=e.data();let n=document.querySelector("#injbody"),i=document.createElement("div");i.setAttribute("class","cardItem");let s=document.createElement("div");s.setAttribute("class","blog-card");let r=document.createElement("img");t.Cover&&r.setAttribute("src",t.Cover);let o=document.createElement("div");o.setAttribute("class","title-content");let a=document.createElement("h3"),c=document.createElement("a");c.innerHTML=t.title;let u=document.createElement("div");u.setAttribute("class","card-info");let h=document.createElement("a");h.href="#",h.innerHTML="More about this event",h.addEventListener("click",(()=>{localStorage.removeItem("show"),localStorage.setItem("show",JSON.stringify({type:"events",item:e.id})),window.location.href="cardDisplay.html"}));let l=document.createElement("div");l.setAttribute("class","gradient-overlay");let d=document.createElement("div");d.setAttribute("class","color-overlay"),a.appendChild(c),o.appendChild(a),u.appendChild(h),s.appendChild(r),s.appendChild(o),s.appendChild(u),s.appendChild(l),s.appendChild(d),i.appendChild(s),n.append(i)}))})).catch((e=>{throw new Error("couldn't retrive documents")}));const t=ml(Yh(mp.database,"/articles"),vl("created_at","desc"),Il(2));await El(t).then((e=>{e.size>0&&e.docs.forEach((e=>{let t=e.data();const n=document.querySelector("#injbody2");let i=document.createElement("a");i.setAttribute("class","articleCard daily"),i.addEventListener("click",(()=>{localStorage.removeItem("show"),localStorage.setItem("show",JSON.stringify({type:"articles",item:e.id})),window.location.href="cardDisplay.html"}));let s=document.createElement("div");s.setAttribute("class","cardImage");let r=document.createElement("img");t.Cover&&(r.src=t.Cover);let o=document.createElement("div");o.setAttribute("class","cardInfo");let a=document.createElement("h2");a.innerHTML=t.title;let c=document.createElement("span");c.id="cateholder";for(let e of t.Category){let t=document.createElement("span");t.setAttribute("class","category"),t.innerHTML=e,c.appendChild(t)}let u=document.createElement("p");t.Subheader&&(u.innerHTML=t.Subheader);let h=document.createElement("span");h.setAttribute("class","postDate"),h.innerHTML=t.created_at,t.Cover&&s.appendChild(r),o.appendChild(a),o.appendChild(c),o.appendChild(u),o.appendChild(h),i.appendChild(s),i.appendChild(o),n.appendChild(i)}))})).catch((e=>{throw new Error("couldn't retrive documents")})),async function(){try{let e=Yh(mp.database,"/sponsers"),t=await El(e).catch((e=>{throw new Error("couldn't retrive documents")}));if(!t.empty){let e=document.getElementById("sponser_injbody");if(!e)return!1;t.docs.forEach((t=>{let n=document.createElement("a"),i=document.createElement("img");t.data().logo?i.src=t.data().logo:n.innerText=t.data().id,n.appendChild(i),e.appendChild(n)}))}}catch(e){return!1}}(),async function(){try{let e=document.getElementById("featured_injbody");if(!e)return!1;let t=ml(Yh(mp.database,"articles"),vl("modified_at","desc"),Il(3)),n=await El(t).catch((e=>new Error("couldn't retrive docuemnts")));if(!n.empty){let t=document.getElementById("slider_nav"),i=0;n.docs.forEach((n=>{i++;let s=document.createElement("figure");s.classList.add("js-slider_item","img-"+i);let r=document.createElement("div");r.classList.add("js-slider_img");let o=document.createElement("img");o.classList.add("c-img-w-full"),n.data().Cover&&(o.src=n.data().Cover),r.appendChild(o),s.appendChild(r),e.insertBefore(s,t)}))}}catch(e){return!1}}()}catch(e){return!1}}()}()}),2e3)})();